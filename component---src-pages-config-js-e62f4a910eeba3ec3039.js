(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"/Ina":function(e,t,n){"use strict";n("rGqo"),n("yt8O"),n("Btvt"),n("RW0V"),n("91GP"),n("bWfx"),n("bHtr");var a=n("wx14"),s=n("mwIZ"),i=n.n(s),o=n("rxyn"),r=n("a3Sb"),c=n("WwGW"),l=n("Nreb"),m=n("17x9"),p=n("q1tI"),d=n("AMYI"),u=n("7X27"),b=n("ihDb"),h=n("wX7S"),f=function e(t){var n=p.useContext(d.b),s=Object(o.a)(e.displayName,n.telemetry),m=s.setStart,u=s.setEnd;m();var b=t.children,h=t.className,f=t.column,y=t.debug,g=t.design,v=t.fill,O=t.gap,j=t.hAlign,w=t.inline,x=t.padding,C=t.space,E=t.styles,N=t.variables,P=t.vAlign,T=t.wrap,S=Object(r.a)(e.displayName,{className:e.className,mapPropsToStyles:function(){return{column:f,debug:y,fill:v,gap:O,hAlign:j,inline:w,padding:x,space:C,vAlign:P,wrap:T}},mapPropsToInlineStyles:function(){return{className:h,design:g,styles:E,variables:N}},rtl:n.rtl}).classes,I=Object(c.a)(t),A=Object(l.a)(e.handledProps,t),D=p.Children.map(b,(function(e){return i()(e,"type.__isFlexItem")?p.cloneElement(e,{flexDirection:f?"column":"row"}):e})),k=p.createElement(I,Object(a.a)({className:S.root},A),D);return u(),k};f.className="ui-flex",f.displayName="Flex",f.propTypes=Object.assign({},u.commonPropTypes.createCommon({accessibility:!1,content:!1}),{inline:m.bool,column:m.bool,wrap:m.bool,hAlign:m.oneOf(["start","center","end","stretch"]),vAlign:m.oneOf(["start","center","end","stretch"]),space:m.oneOf(["around","between","evenly"]),gap:m.oneOf(["gap.smaller","gap.small","gap.medium","gap.large"]),padding:m.oneOf(["padding.medium"]),fill:m.bool,debug:m.bool}),f.handledProps=Object.keys(f.propTypes),f.Item=h.a,t.a=Object(b.a)(f)},JWvD:function(e,t,n){"use strict";n("91GP");var a=n("wx14"),s=n("1OyB"),i=n("vuIU"),o=n("md7G"),r=n("foSv"),c=n("Ji7U"),l=n("rePB"),m=n("q1tI"),p=n("4o4N"),d=n("oPHA"),u=n("QyKD"),b=n("7X27"),h=n("yX7n"),f=n("ihDb"),y=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"renderComponent",value:function(e){var t=e.accessibility,n=e.ElementType,s=e.classes,i=e.unhandledProps,o=this.props,r=o.children,c=o.content;return m.createElement(n,Object(a.a)({},p.a.getAttributes({forElements:[r,c]}),t.attributes.root,i,{className:s.root}),Object(d.a)(r)?r:c)}}]),t}(u.a);Object(l.a)(y,"create",void 0),Object(l.a)(y,"className","ui-header__description"),Object(l.a)(y,"displayName","HeaderDescription"),Object(l.a)(y,"propTypes",Object.assign({},b.commonPropTypes.createCommon({color:!0}))),Object(l.a)(y,"defaultProps",{as:"p"}),y.create=Object(h.a)({Component:y,mappedProp:"content"}),t.a=Object(f.a)(y)},iUi7:function(e,t,n){"use strict";n("91GP");var a=n("wx14"),s=n("1OyB"),i=n("vuIU"),o=n("md7G"),r=n("foSv"),c=n("Ji7U"),l=n("rePB"),m=n("LfD4"),p=n("17x9"),d=n("q1tI"),u=n("oPHA"),b=n("4o4N"),h=n("QyKD"),f=n("7X27"),y=n("yX7n"),g=n("JWvD"),v=n("ihDb"),O=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(i.a)(t,[{key:"renderComponent",value:function(e){var n=e.accessibility,s=e.ElementType,i=e.classes,o=e.variables,r=e.unhandledProps,c=this.props,l=c.children,m=c.description,p=c.content,h=Object(u.a)(l),f=Object(u.a)(l)?l:p;return d.createElement(s,Object(a.a)({},b.a.getAttributes({forElements:[l,p],condition:!m}),n.attributes.root,r,{className:i.root}),b.a.createFor({element:f,condition:!!m}),!h&&g.a.create(m,{defaultProps:function(){return{className:t.slotClassNames.description,variables:Object.assign({},o.descriptionColor&&{color:o.descriptionColor})}}}))}}]),t}(h.a);Object(l.a)(O,"displayName","Header"),Object(l.a)(O,"className","ui-header"),Object(l.a)(O,"slotClassNames",{description:"".concat(O.className,"__description")}),Object(l.a)(O,"create",void 0),Object(l.a)(O,"propTypes",Object.assign({},f.commonPropTypes.createCommon({color:!0}),{description:m.i,align:m.b,rtlAttributes:p.func})),Object(l.a)(O,"defaultProps",{as:"h1"}),Object(l.a)(O,"Description",g.a),O.create=Object(y.a)({Component:O,mappedProp:"content"}),t.a=Object(v.a)(O)},kQFk:function(e,t,n){"use strict";n.r(t);n("VRzm"),n("Btvt");var a=n("o0o1"),s=n.n(a),i=(n("ls82"),n("f3/d"),n("q1tI")),o=n.n(i),r=n("3r0M"),c=n("XyXI"),l=n("iUi7"),m=n("/Ina"),p=n("wX7S"),d=n("KZyE"),u=n("wXOM"),b=n("Skks");function h(e,t,n,a,s,i,o){try{var r=e[i](o),c=r.value}catch(l){return void n(l)}r.done?t(c):Promise.resolve(c).then(a,s)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var y={mainPadding:{padding:"2em"},mainSidePadding:{padding:"10px 2em"},mainPdf:{display:"flex",justifyContent:"center"},mainTable:{backgroundColor:"#fff",border:"1px solid #d8e2f0",borderRadius:"4px",boxShadow:"0 0 10px 0 rgba(19,29,41,.05)",position:"relative",padding:"0em 3em 2em"},backButton:{cusor:"pointer"}},g=function(e){var t,n;function a(){var t;return(t=e.call(this)||this).microsoftTeams&&t.microsoftTeams.initialize(),t.state={apiKey:"",adminId:"",contacts:null,contact:null},t.handleChange=t.handleChange.bind(f(t)),t.submit=t.submit.bind(f(t)),t.getOptions=t.getOptions.bind(f(t)),t.handleContact=t.handleContact.bind(f(t)),t.save=t.save.bind(f(t)),t}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var i=a.prototype;return i.componentDidMount=function(){this.microsoftTeams=window?window.microsoftTeams:null},i.getOptions=function(){return this.state.contacts.map((function(e){return{content:e.company_name,value:e.id}}))},i.handleContact=function(e,t){this.setState({contact:t.value})},i.handleChange=function(e){var t;this.setState(((t={})[e.target.name]=e.target.value,t))},i.submit=function(){var e,t=(e=s.a.mark((function e(t){var n,a,i,o,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=this.state,a=n.apiKey,i=n.adminId,n.value,e.prev=2,e.next=5,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:i+"/contacts.json",key:a})});case 5:return o=e.sent,e.next=8,o.json();case 8:r=e.sent,console.log({json:r}),this.setState({contacts:r}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),console.log("BOOM!"),console.log(e.t0);case 17:case"end":return e.stop()}}),e,this,[[2,13]])})),function(){var t=this,n=arguments;return new Promise((function(a,s){var i=e.apply(t,n);function o(e){h(i,a,s,o,r,"next",e)}function r(e){h(i,a,s,o,r,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}(),i.save=function(e){var t=this;e.preventDefault();var n=this.state,a=n.apiKey,s=n.adminId,i=n.contact;this.microsoftTeams.initialize(),this.microsoftTeams.settings.setValidityState(!0),this.microsoftTeams.settings.registerOnSaveHandler((function(e){t.microsoftTeams.settings.setSettings({websiteUrl:"https://jp5525.github.io/teams-demo",contentUrl:"https://jp5525.github.io/teams-demo",entityId:JSON.stringify({apiKey:a,adminId:s,contact:i}),suggestedDisplayName:"InvoicesTab"}),e.notifySuccess()}))},i.render=function(){var e=this.state,t=e.contacts,n=e.contact;return o.a.createElement(r.a,{theme:c.themes.teams},o.a.createElement("div",{style:y.mainPadding},o.a.createElement("div",{style:y.mainTable},o.a.createElement(l.a,{content:"MoneyBird API"}),o.a.createElement(m.a,{gap:"gap.small",vAlign:"center",hAlign:"start"},o.a.createElement(p.a,{justifyContent:"center"},o.a.createElement("form",{onSubmit:this.submit},o.a.createElement(d.a,{type:"text",placeholder:"apiKey",name:"apiKey",id:"apiKey",onChange:this.handleChange})," ",o.a.createElement("br",null),o.a.createElement(d.a,{type:"text",placeholder:"admin id",name:"adminId",id:"adminId",onChange:this.handleChange})," ",o.a.createElement("br",null),o.a.createElement(u.a,{primary:!0},"Fetch Contacts")))))),o.a.createElement("div",{style:y.mainSidePadding},o.a.createElement("div",{style:y.mainTable},o.a.createElement(l.a,{content:"MoneyBird Contact"}),o.a.createElement(m.a,{gap:"gap.small",vAlign:"center",hAlign:"start"},o.a.createElement(p.a,{justifyContent:"center"},o.a.createElement("form",{onSubmit:this.save},o.a.createElement(b.a,{items:t?this.getOptions():[],value:n?n.content:null,placeholder:"Contacts",onChange:this.handleContact,name:"contact",disabled:!t}),o.a.createElement(u.a,{primary:!0},"Fetch Invoices")))))))},a}(o.a.Component);t.default=g},wX7S:function(e,t,n){"use strict";n("91GP");var a=n("J2iB"),s=n.n(a),i=n("rxyn"),o=n("a3Sb"),r=n("/3ou"),c=n("TSYQ"),l=n.n(c),m=n("17x9"),p=n("q1tI"),d=n("AMYI"),u=n("7X27"),b=function e(t){var n=p.useContext(d.b),a=Object(i.a)(e.displayName,n.telemetry),c=a.setStart,m=a.setEnd;c();var u,b=t.align,h=t.children,f=t.className,y=t.design,g=t.grow,v=t.flexDirection,O=t.push,j=t.shrink,w=t.size,x=t.styles,C=t.variables,E=Object(o.a)(e.displayName,{className:e.className,mapPropsToStyles:function(){return{align:b,grow:g,flexDirection:v,push:O,shrink:j,size:w}},mapPropsToInlineStyles:function(){return{className:f,design:y,styles:x,variables:C}},rtl:n.rtl}),N=E.classes,P=E.styles;return u="function"==typeof h?h({styles:P.root,classes:N.root}):s()(h)?null:function(e,t,n){return t?"string"==typeof e.type?p.cloneElement(e,{className:l()(e.props.className,n.root)}):p.cloneElement(e,{styles:Object(r.f)(t.root||{},e.props.styles)}):e}(p.Children.only(h),P,N),m(),u};b.className="ui-flex__item",b.displayName="FlexItem",b.propTypes=Object.assign({},u.commonPropTypes.createCommon({children:!1,accessibility:!1,content:!1}),{children:m.oneOfType([m.element,m.func]),align:m.oneOf(["auto","start","end","center","baseline","stretch"]),size:m.oneOfType([m.oneOf(["size.half","size.quarter","size.small","size.medium","size.large"]),m.string]),shrink:m.oneOfType([m.bool,m.number]),push:m.bool,flexDirection:m.oneOf(["row","column"])}),b.__isFlexItem=!0,t.a=b}}]);
//# sourceMappingURL=component---src-pages-config-js-e62f4a910eeba3ec3039.js.map