(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"/Ina":function(e,t,n){"use strict";n("rGqo"),n("yt8O"),n("Btvt"),n("RW0V"),n("91GP"),n("bWfx"),n("bHtr");var a=n("wx14"),i=n("mwIZ"),o=n.n(i),r=n("rxyn"),s=n("a3Sb"),l=n("WwGW"),c=n("Nreb"),u=n("17x9"),m=n("q1tI"),d=n("AMYI"),p=n("7X27"),h=n("ihDb"),b=n("wX7S"),f=function e(t){var n=m.useContext(d.b),i=Object(r.a)(e.displayName,n.telemetry),u=i.setStart,p=i.setEnd;u();var h=t.children,b=t.className,f=t.column,y=t.debug,g=t.design,v=t.fill,O=t.gap,j=t.hAlign,T=t.inline,w=t.padding,S=t.space,E=t.styles,k=t.variables,P=t.vAlign,x=t.wrap,A=Object(s.a)(e.displayName,{className:e.className,mapPropsToStyles:function(){return{column:f,debug:y,fill:v,gap:O,hAlign:j,inline:T,padding:w,space:S,vAlign:P,wrap:x}},mapPropsToInlineStyles:function(){return{className:b,design:g,styles:E,variables:k}},rtl:n.rtl}).classes,I=Object(l.a)(t),N=Object(c.a)(e.handledProps,t),C=m.Children.map(h,(function(e){return o()(e,"type.__isFlexItem")?m.cloneElement(e,{flexDirection:f?"column":"row"}):e})),z=m.createElement(I,Object(a.a)({className:A.root},N),C);return p(),z};f.className="ui-flex",f.displayName="Flex",f.propTypes=Object.assign({},p.commonPropTypes.createCommon({accessibility:!1,content:!1}),{inline:u.bool,column:u.bool,wrap:u.bool,hAlign:u.oneOf(["start","center","end","stretch"]),vAlign:u.oneOf(["start","center","end","stretch"]),space:u.oneOf(["around","between","evenly"]),gap:u.oneOf(["gap.smaller","gap.small","gap.medium","gap.large"]),padding:u.oneOf(["padding.medium"]),fill:u.bool,debug:u.bool}),f.handledProps=Object.keys(f.propTypes),f.Item=b.a,t.a=Object(h.a)(f)},JWvD:function(e,t,n){"use strict";n("91GP");var a=n("wx14"),i=n("1OyB"),o=n("vuIU"),r=n("md7G"),s=n("foSv"),l=n("Ji7U"),c=n("rePB"),u=n("q1tI"),m=n("4o4N"),d=n("oPHA"),p=n("QyKD"),h=n("7X27"),b=n("yX7n"),f=n("ihDb"),y=function(e){function t(){return Object(i.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"renderComponent",value:function(e){var t=e.accessibility,n=e.ElementType,i=e.classes,o=e.unhandledProps,r=this.props,s=r.children,l=r.content;return u.createElement(n,Object(a.a)({},m.a.getAttributes({forElements:[s,l]}),t.attributes.root,o,{className:i.root}),Object(d.a)(s)?s:l)}}]),t}(p.a);Object(c.a)(y,"create",void 0),Object(c.a)(y,"className","ui-header__description"),Object(c.a)(y,"displayName","HeaderDescription"),Object(c.a)(y,"propTypes",Object.assign({},h.commonPropTypes.createCommon({color:!0}))),Object(c.a)(y,"defaultProps",{as:"p"}),y.create=Object(b.a)({Component:y,mappedProp:"content"}),t.a=Object(f.a)(y)},Pr5a:function(e,t,n){"use strict";var a=n("q1tI"),i=n("TSYQ"),o=n.n(i),r=n("tIxt"),s=n("Z+mF"),l=Object(r.a)({svg:function(e){var t=e.classes;return a.createElement("svg",{role:"presentation",focusable:"false",viewBox:"8 8 16 16",className:t.svg},a.createElement("g",null,a.createElement("path",{className:o()(s.a.outline,t.outlinePart),d:"M16.707 16l4.243-4.243a.5.5 0 1 0-.707-.707L16 15.293l-4.243-4.243a.5.5 0 1 0-.707.707L15.293 16l-4.243 4.243a.5.5 0 1 0 .707.707L16 16.707l4.243 4.243a.498.498 0 0 0 .707 0 .5.5 0 0 0 0-.707L16.707 16z"}),a.createElement("path",{className:o()(s.a.filled,t.filledPart),d:"M17.414 16l3.89-3.89a1 1 0 1 0-1.415-1.413L16 14.586l-3.89-3.89a1 1 0 1 0-1.413 1.415L14.586 16l-3.89 3.89a1 1 0 1 0 1.415 1.413L16 17.414l3.89 3.89a.997.997 0 0 0 1.413 0 1 1 0 0 0 0-1.415L17.414 16z"})))},displayName:"CloseIcon"});t.a=l},U5J5:function(e,t,n){"use strict";var a=n("q1tI"),i=n("TSYQ"),o=n.n(i),r=n("tIxt"),s=n("Z+mF"),l=Object(r.a)({svg:function(e){var t=e.classes;return a.createElement("svg",{role:"presentation",focusable:"false",viewBox:"8 8 16 16",className:t.svg},a.createElement("g",null,a.createElement("path",{className:o()(s.a.outline,t.outlinePart),d:"M14.3 21.3c-.1 0-.3 0-.4-.1l-4.8-4.8c-.2-.2-.2-.5 0-.7s.5-.2.7 0l4.4 4.4 7.9-7.9c.2-.2.5-.2.7 0s.2.5 0 .7l-8.3 8.3s-.1.1-.2.1z"}),a.createElement("path",{className:o()(s.a.filled,t.filledPart),d:"M23.5 11.875a.968.968 0 0 1-.289.711l-8.25 8.25c-.192.193-.43.289-.711.289s-.519-.096-.711-.289l-4.75-4.75a.965.965 0 0 1-.289-.711c0-.125.027-.25.082-.375s.129-.234.223-.328a.953.953 0 0 1 .695-.297c.135 0 .266.025.391.074.125.05.231.121.32.215l4.039 4.047 7.539-7.547a.886.886 0 0 1 .32-.215c.125-.049.255-.074.391-.074a1.004 1.004 0 0 1 .922.625.97.97 0 0 1 .078.375z"})))},displayName:"AcceptIcon"});t.a=l},iUi7:function(e,t,n){"use strict";n("91GP");var a=n("wx14"),i=n("1OyB"),o=n("vuIU"),r=n("md7G"),s=n("foSv"),l=n("Ji7U"),c=n("rePB"),u=n("LfD4"),m=n("17x9"),d=n("q1tI"),p=n("oPHA"),h=n("4o4N"),b=n("QyKD"),f=n("7X27"),y=n("yX7n"),g=n("JWvD"),v=n("ihDb"),O=function(e){function t(){return Object(i.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"renderComponent",value:function(e){var n=e.accessibility,i=e.ElementType,o=e.classes,r=e.variables,s=e.unhandledProps,l=this.props,c=l.children,u=l.description,m=l.content,b=Object(p.a)(c),f=Object(p.a)(c)?c:m;return d.createElement(i,Object(a.a)({},h.a.getAttributes({forElements:[c,m],condition:!u}),n.attributes.root,s,{className:o.root}),h.a.createFor({element:f,condition:!!u}),!b&&g.a.create(u,{defaultProps:function(){return{className:t.slotClassNames.description,variables:Object.assign({},r.descriptionColor&&{color:r.descriptionColor})}}}))}}]),t}(b.a);Object(c.a)(O,"displayName","Header"),Object(c.a)(O,"className","ui-header"),Object(c.a)(O,"slotClassNames",{description:"".concat(O.className,"__description")}),Object(c.a)(O,"create",void 0),Object(c.a)(O,"propTypes",Object.assign({},f.commonPropTypes.createCommon({color:!0}),{description:u.i,align:u.b,rtlAttributes:m.func})),Object(c.a)(O,"defaultProps",{as:"h1"}),Object(c.a)(O,"Description",g.a),O.create=Object(y.a)({Component:O,mappedProp:"content"}),t.a=Object(v.a)(O)},kQFk:function(e,t,n){"use strict";n.r(t);n("a1Th"),n("XfO3"),n("HEwt"),n("rE2o"),n("ioFf"),n("VRzm"),n("rGqo"),n("yt8O"),n("Btvt"),n("KKXr"),n("f3/d");var a=n("o0o1"),i=n.n(a),o=(n("ls82"),n("q1tI")),r=n.n(o),s=n("sBL/"),l=n.n(s),c=n("3r0M"),u=n("XyXI"),m=n("iUi7"),d=n("/Ina"),p=n("wX7S"),h=n("iY3s"),b=n("Skks"),f=n("Pr5a"),y=n("U5J5");function g(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function O(e,t,n,a,i,o,r){try{var s=e[o](r),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(a,i)}function j(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function r(e){O(o,a,i,r,s,"next",e)}function s(e){O(o,a,i,r,s,"throw",e)}r(void 0)}))}}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var w={mainPadding:{padding:"0px 2em"},mainSidePadding:{padding:"10px 2em"},mainPdf:{display:"flex",justifyContent:"center"},mainTable:{backgroundColor:"#fff",border:"1px solid #d8e2f0",borderRadius:"4px",boxShadow:"0 0 10px 0 rgba(19,29,41,.05)",position:"relative",padding:"0em 3em 2em"},backButton:{cusor:"pointer"},label:{fontWeight:"bold"}},S={en:{heading:"Moneybird Configuration",apiSection:{title:r.a.createElement("label",{style:w.label},"API Token"),description:r.a.createElement("span",null,"This is the API Token for you MoneyBird Account. You can generate one ",r.a.createElement("a",{target:"_blank",href:"https://moneybird.com/user/applications/new"},"here")," for personal use."),succsess:"API Token IS vaild",fail:"API Token NOT vaild",placeholder:"API Token"},adminSection:{title:r.a.createElement("label",{style:w.label},"Administration"),description:r.a.createElement("span",null,"This is the administration you created your API Token for"),placeholder:"Administration"},contactSection:{title:r.a.createElement("label",{style:w.label},"Contact"),description:r.a.createElement("span",null,"The contact whos invoice's will show up on the invoices tabs"),placeholder:"Contact"},tabTitle:"Moneybird Invoices"},nl:{heading:"Moneybird Koppelen",apiSection:{title:r.a.createElement("label",{style:w.label},"API token invoeren"),description:r.a.createElement("span",null,"Vul hier een API-token in van je Moneybird account. Je kunt ",r.a.createElement("a",{target:"_blank",href:"https://moneybird.com/user/applications/new"},"hier")," een API-token genereren. Vul een naam in die herkenbaar is voor deze connectie, bijvoorbeeld ‘Microsoft Teams Integratie’. Kies voor ‘API token voor persoonlijk gebruik’ en geef in ieder geval toegang voor alle onderdelen. Vervolgens verschijnt er een API-token in beeld. Vul deze hieronder in."),succsess:"API-token niet geldig",fail:"API-token IS geldig",placeholder:"API token invoeren"},adminSection:{title:r.a.createElement("label",{style:w.label},"Toediening"),description:r.a.createElement("span",null,"Dit is de administratie van waaruit u contacten wilt bekijken"),placeholder:"Administratie"},contactSection:{title:r.a.createElement("label",{style:w.label},"Contact"),description:r.a.createElement("span",null,"Selecteer de Contact waarvan je de facturen wilt tonen in de Tab."),placeholder:"contact"},tabTitle:"Moneybird facturen"}},E=function(e){var t,n;function a(){var t;return(t=e.call(this)||this).microsoftTeams&&t.microsoftTeams.initialize(),t.state={apiKey:"",adminId:"",admins:null,admin:null,contacts:null,contact:null,keys:[],isNew:!1,isOpen:!1},t.handleChange=t.handleChange.bind(T(t)),t.submit=t.submit.bind(T(t)),t.getOptions=t.getOptions.bind(T(t)),t.handleContact=t.handleContact.bind(T(t)),t.save=t.save.bind(T(t)),t.getAdmin=l()(t.getAdmin,2e3).bind(T(t)),t.handleToken=t.handleToken.bind(T(t)),t.handleAdmin=t.handleAdmin.bind(T(t)),t}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=a.prototype;return o.getAdmin=function(){var e=j(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:"administrations.json",key:t})});case 3:return n=e.sent,e.next=6,n.json();case 6:a=e.sent,console.log({json:a}),a.error?this.setState({admins:!1}):this.setState({admins:a}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),o.componentDidMount=function(){var e=this;this.microsoftTeams=window?window.microsoftTeams:null,this.microsoftTeams.initialize(),this.microsoftTeams.getContext(function(){var t=j(i.a.mark((function t(n){var a,o,r,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.tid,o=n.locale,t.prev=1,t.next=4,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/key/"+a,{mode:"cors",method:"GET"});case 4:return r=t.sent,t.next=7,r.json();case 7:s=t.sent,console.log({json:s}),e.setState({keys:s.map((function(e){return e.key})),locale:o}),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),console.log("BOOMER!"),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e){return t.apply(this,arguments)}}().bind(this))},o.getOptions=function(){return this.state.contacts.map((function(e){return{content:e.company_name,value:e.id}}))},o.handleContact=function(e,t){this.setState({contact:t.value},this.save)},o.handleAdmin=function(e,t){this.setState({admin:t.value}),this.submit(t.value)},o.handleChange=function(e){var t;this.setState(((t={})[e.target.name]=e.target.value,t))},o.handleToken=function(e,t){console.log({e:e,v:t}),e?(this.setState({apiKey:e.target.value,isOpen:!0}),this.getAdmin(e.target.value)):t&&(this.setState({apiKey:t.value,isOpen:!1}),this.getAdmin(t.value))},o.submit=function(){var e=j(i.a.mark((function e(t){var n,a,o,r,s=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.value,console.log(n),a=this.state,o=a.apiKey,r=a.isNew,this.microsoftTeams.initialize(),this.microsoftTeams.getContext(function(){var e=j(i.a.mark((function e(t){var a,l,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.tid,e.prev=1,e.next=4,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:n+"/contacts.json",key:o,tid:a,isNew:r})});case 4:return l=e.sent,e.next=7,l.json();case 7:c=e.sent,console.log({json:c}),s.setState({contacts:c}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.log("BOOM!"),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o.save=function(){var e=this,t=this.state,n=t.apiKey,a=t.admin.value,i=t.contact,o=t.locale.split("-")[0];this.microsoftTeams.initialize(),this.microsoftTeams.settings.setValidityState(!0),this.microsoftTeams.settings.registerOnSaveHandler((function(t){e.microsoftTeams.settings.setSettings({websiteUrl:"https://jp5525.github.io/teams-demo/"+o+"/",contentUrl:"https://jp5525.github.io/teams-demo/"+o+"/",entityId:JSON.stringify({apiKey:n,adminId:a,contact:i}),suggestedDisplayName:S[o].tabTitle}),t.notifySuccess()}))},o.render=function(){var e=this,t=this.state,n=t.contacts,a=t.contact,i=t.admins,o=t.admin,s=t.apiKey,l=t.keys,v=t.isOpen,O=t.locale,j=O?S[O.split("-")[0]]:null;return console.log({keys:l}),j?r.a.createElement(c.a,{theme:u.themes.teams},r.a.createElement("div",{style:w.mainPadding},r.a.createElement("div",{style:w.mainTable},r.a.createElement(m.a,{content:j.heading}),r.a.createElement(d.a,{gap:"gap.small",vAlign:"center",hAlign:"start"},r.a.createElement(p.a,{justifyContent:"center"},r.a.createElement("form",{onSubmit:this.submit,style:{width:"100%"}},j.apiSection.title," ",r.a.createElement("br",null),j.apiSection.description,0==i?r.a.createElement(r.a.Fragment,null," ",r.a.createElement("br",null),r.a.createElement(h.a,{content:j.apiSection.fail,icon:{as:f.a}})):null,i?r.a.createElement(r.a.Fragment,null," ",r.a.createElement("br",null),r.a.createElement(h.a,{content:j.apiSection.succsess,icon:{as:y.a}})):null,r.a.createElement(b.a,{items:l,placeholder:j.apiSection.placeholder,onChange:this.handleToken,name:"apiKey",id:"apiKey",clearable:s&&s.length>0,fluid:!0,search:!0,open:v,noResultsMessage:{content:"Add... "+s,onClick:function(t){e.setState({isNew:!0,keys:[s].concat(g(l)),isOpen:!1},e.getAdmin(s))},style:{cursor:"pointer"}}}),r.a.createElement("br",null),j.adminSection.title," ",r.a.createElement("br",null),j.adminSection.description,r.a.createElement(b.a,{items:i?i.map((function(e){return{content:e.name,value:e.id}})):[],value:o?o.content:null,placeholder:j.adminSection.placeholder,onChange:this.handleAdmin,name:"Admin",disabled:!i,fluid:!0}),r.a.createElement("br",null),j.contactSection.title," ",r.a.createElement("br",null),j.contactSection.description,r.a.createElement(b.a,{items:n?this.getOptions():[],value:a?a.content:null,placeholder:j.contactSection.placeholder,onChange:this.handleContact,name:"contact",disabled:!n}))))))):null},a}(r.a.Component);t.default=E},"sBL/":function(e,t,n){function a(e,t,n){var a,i,o,r,s;function l(){var c=Date.now()-r;c<t&&c>=0?a=setTimeout(l,t-c):(a=null,n||(s=e.apply(o,i),o=i=null))}null==t&&(t=100);var c=function(){o=this,i=arguments,r=Date.now();var c=n&&!a;return a||(a=setTimeout(l,t)),c&&(s=e.apply(o,i),o=i=null),s};return c.clear=function(){a&&(clearTimeout(a),a=null)},c.flush=function(){a&&(s=e.apply(o,i),o=i=null,clearTimeout(a),a=null)},c}n("eM6i"),a.debounce=a,e.exports=a},wX7S:function(e,t,n){"use strict";n("91GP");var a=n("J2iB"),i=n.n(a),o=n("rxyn"),r=n("a3Sb"),s=n("/3ou"),l=n("TSYQ"),c=n.n(l),u=n("17x9"),m=n("q1tI"),d=n("AMYI"),p=n("7X27"),h=function e(t){var n=m.useContext(d.b),a=Object(o.a)(e.displayName,n.telemetry),l=a.setStart,u=a.setEnd;l();var p,h=t.align,b=t.children,f=t.className,y=t.design,g=t.grow,v=t.flexDirection,O=t.push,j=t.shrink,T=t.size,w=t.styles,S=t.variables,E=Object(r.a)(e.displayName,{className:e.className,mapPropsToStyles:function(){return{align:h,grow:g,flexDirection:v,push:O,shrink:j,size:T}},mapPropsToInlineStyles:function(){return{className:f,design:y,styles:w,variables:S}},rtl:n.rtl}),k=E.classes,P=E.styles;return p="function"==typeof b?b({styles:P.root,classes:k.root}):i()(b)?null:function(e,t,n){return t?"string"==typeof e.type?m.cloneElement(e,{className:c()(e.props.className,n.root)}):m.cloneElement(e,{styles:Object(s.f)(t.root||{},e.props.styles)}):e}(m.Children.only(b),P,k),u(),p};h.className="ui-flex__item",h.displayName="FlexItem",h.propTypes=Object.assign({},p.commonPropTypes.createCommon({children:!1,accessibility:!1,content:!1}),{children:u.oneOfType([u.element,u.func]),align:u.oneOf(["auto","start","end","center","baseline","stretch"]),size:u.oneOfType([u.oneOf(["size.half","size.quarter","size.small","size.medium","size.large"]),u.string]),shrink:u.oneOfType([u.bool,u.number]),push:u.bool,flexDirection:u.oneOf(["row","column"])}),h.__isFlexItem=!0,t.a=h}}]);
//# sourceMappingURL=component---src-pages-config-js-ee0b6ba23ffaf341b601.js.map