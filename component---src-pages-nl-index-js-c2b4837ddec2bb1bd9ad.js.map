{"version":3,"sources":["webpack:///./src/pages/nl/index.js"],"names":["pdfjs","GlobalWorkerOptions","workerSrc","version","styles","mainPadding","mainSidePadding","padding","mainPdf","display","justifyContent","mainTable","backgroundColor","border","borderRadius","boxShadow","position","backButton","cusor","arrow","borderWidth","cursor","download","transform","mainHeader","langs","en","tableHeadings","invoiceId","reference","date","amount","status","statuses","open","className","draft","paid","late","currency","r","Intl","NumberFormat","style","format","total_unpaid","nl","downloadPdf","ab","fileName","blob","Blob","type","FileSaver","saveAs","IndexPage","state","invoices","crrInvoice","apiKey","adminId","crrRow","loading","numOfPages","setActive","bind","clearActive","onDownloadMain","onDownloadRow","fetchPdf","onDocumentLoadSuccess","pdfId","a","this","fetch","mode","method","body","JSON","stringify","path","key","res","arrayBuffer","e","setState","id","pdf","invoice_id","numPages","componentDidMount","microsoftTeams","window","initialize","getContext","entityId","locale","parse","contactId","contact","value","json","render","lang","split","columns","name","selector","sortable","maxWidth","minWidth","right","cell","width","onClick","file","onLoadSuccess","Array","from","el","index","pageNumber","length","data","onRowClicked","pointerOnHover","highlightOnHover","noHeader","React","Component"],"mappings":"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","file":"component---src-pages-nl-index-js-c2b4837ddec2bb1bd9ad.js","sourcesContent":["import React from 'react';\nimport DataTable, { createTheme } from 'react-data-table-component';\nimport { Document, Page, pdfjs } from 'react-pdf';\nimport FileSaver from 'file-saver';\nimport Loader from \"../../components/Loader\"\nimport '../../assets/sass/main.scss';\npdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.js`;\n\nconst styles={\n    mainPadding:null,\n    mainSidePadding:{padding:\"15px 1em\"},\n    mainPdf:{display:\"flex\", justifyContent:\"center\"},\n    mainTable:{\n        backgroundColor: \"#fff\",\n        border: \"1px solid #d8e2f0\",\n        borderRadius: \"4px\",\n        boxShadow: \"0 0 10px 0 rgba(19,29,41,.05)\",\n        position: \"relative\",\n    },\n    backButton:{\n        cusor:\"pointer\"\n    },\n    arrow:{\n        \n        border: \"solid black\",\n        borderWidth: \"0 4px 4px 0\",\n        display: \"inline-block\",\n        padding: \"3px\",\n        cursor: \"pointer\"\n    },\n    \n    download:{\n        transform: \"scale(1.5)\",\n        border: \"none\"\n    },\n    mainHeader:{\n        display:\"flex\",\n        justifyContent:\"space-between\"\n    }\n}\n\nconst langs ={\n    en:{\n        tableHeadings:{\n            invoiceId:\"Invoice id\",\n            reference:\"Reference\",\n            date:\"Invoice date\",\n            amount:\"Amount\",\n            status:\"Status\"\n        },\n        statuses:{\n            open:<div className=\"state-label state-label--full-width state-label--warning\"><span className=\"state-label__text\">open</span></div>,\n            draft:<div className=\"state-label state-label--full-width state-label--warning\"><span className=\"state-label__text\">draft</span></div>,\n            paid:<div className=\"state-label state-label--full-width state-label--paid\"><span className=\"state-label__text\">paid</span></div>,\n            late:<div className=\"state-label state-label--full-width state-label--late\"><span className=\"state-label__text\">late</span></div>,\n        },\n        currency: r=>new Intl.NumberFormat('en-us', { style: 'currency', currency: 'USD' }).format(r.total_unpaid)\n    },\n    nl:{\n        tableHeadings:{\n            invoiceId:\"Factuurnummer\",\n            reference:\"Kenmerk\",\n            date:\"Factuurdatum\",\n            amount:\"Bedrag\",\n            status:\"Status\"\n        },\n        statuses:{\n            draft:<div className=\"state-label state-label--full-width state-label--warning\"><span className=\"state-label__text\">Openstaand</span></div>,\n            open:<div className=\"state-label state-label--full-width state-label--warning\"><span className=\"state-label__text\">Verlopen</span></div>,\n            paid:<div className=\"state-label state-label--full-width state-label--paid\"><span className=\"state-label__text\">Betaald</span></div>,\n            late:<div className=\"state-label state-label--full-width state-label--late\"><span className=\"state-label__text\">laat</span></div>,\n        },\n        currency: r=>new Intl.NumberFormat('nl-nl', { style: 'currency', currency: 'EUR' }).format(r.total_unpaid)\n    }\n}\nconst downloadPdf = (ab, fileName) =>{\n    var blob = new Blob([ab], {type: \"application/pdf\"});\n    FileSaver.saveAs(blob, fileName);\n}\n\nclass IndexPage extends React.Component{\n \n    constructor(){\n        super()\n        this.state= {\n            invoices:null,\n            crrInvoice:null,\n            apiKey:null,\n            adminId: null,\n            crrRow: null,\n            loading:true,\n            numOfPages:null\n        }\n        this.setActive= this.setActive.bind(this)\n        this.clearActive = this.clearActive.bind(this)\n        this.onDownloadMain = this.onDownloadMain.bind(this)\n        this.onDownloadRow = this.onDownloadRow.bind(this)\n        this.fetchPdf = this.fetchPdf.bind(this)\n        this.onDocumentLoadSuccess = this.onDocumentLoadSuccess.bind(this)\n    }\n\n    async fetchPdf(pdfId){\n         const {apiKey, adminId} = this.state;\n         \n         const res = await fetch(\n             `https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy`,\n             {\n                 mode:\"cors\",\n                 method:\"POST\",\n                 body: JSON.stringify({\n                     method:\"GET\",\n                     path:`${adminId}/sales_invoices/${pdfId}/download_pdf.json`,\n                     key: apiKey\n                 })\n             }\n         )\n         return await res.arrayBuffer();\n    }\n\n    async setActive(r, e){\n        this.setState({loading:true})\n        const pdf = await this.fetchPdf(r.id)\n        this.setState({crrInvoice:pdf, crrRow: r, loading:false })\n    }\n\n    onDownloadMain(){\n        const {crrInvoice, crrRow} = this.state;\n        downloadPdf(crrInvoice, `${crrRow.invoice_id}.pdf`)\n    }\n    async onDownloadRow(r)\n    {\n       this.setState({loading:true})\n       const pdf = await this.fetchPdf(r.id);\n       this.setState({loading:false })\n       downloadPdf(pdf, `${r.invoice_id}.pdf`)\n    }\n    clearActive(){\n        this.setState({crrInvoice:null})\n    }\n\n    onDocumentLoadSuccess({ numPages }){\n        this.setState({ numOfPages:numPages });\n      }\n\n   componentDidMount(){\n        this.microsoftTeams = window? window.microsoftTeams: null;\n        if(this.microsoftTeams){\n            this.microsoftTeams.initialize();\n            this.microsoftTeams.getContext(async ({entityId, locale}) =>{\n                const {apiKey, adminId, contact:{value :contactId}} = JSON.parse(entityId);\n                const res = await fetch(\n                    `https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy`,\n                    {\n                        mode:\"cors\",\n                        method:\"POST\",\n                        body: JSON.stringify({\n                            method:\"GET\",\n                            path:`${adminId}/sales_invoices.json?filter=contact_id:${contactId}`,\n                            key: apiKey\n                        })\n                    }\n                )\n                const json = await res.json();\n                this.setState({\n                    invoices: json,\n                    adminId,\n                    apiKey,\n                    loading: false,\n                    locale\n                })\n            })\n        }\n    }\n\n    render(){\n        const {crrInvoice, invoices, loading, numOfPages, locale} = this.state;\n        if(!locale) return  <Loader loading={loading}/>\n\n        const lang = langs[\"nl-nl\".split(\"-\")[0]]\n        if(!lang) return <p>Sorry, it doesnt look like we have a translation for {locale.split(\"-\")[0]}</p>\n\n        const columns =[\n            {\n                name:lang.tableHeadings.invoiceId,\n                selector:\"invoice_id\",\n                sortable: true\n            },\n            {\n                name:lang.tableHeadings.reference,\n                selector:\"reference\",\n                sortable: true\n            },\n            {\n                name:lang.tableHeadings.date,\n                selector:\"invoice_date\",\n                sortable: true,\n                maxWidth:\"15%\",\n                minWidth:\"100px\"\n            },\n            {\n                name:lang.tableHeadings.amount,\n                selector:\"total_unpaid\",\n                sortable: true,\n                maxWidth:\"7%\",\n                minWidth:\"85px\",\n                right:true,\n                cell: lang.currency\n            },\n            {\n                name:lang.tableHeadings.status,\n                selector:\"state\",\n                sortable: true,\n                width: \"17%\",\n                cell: r=>lang.statuses[r.state]\n            }\n           \n        ]\n        return (\n            \n            <div >\n               \n                <header style={styles.mainSidePadding}>\n                    {crrInvoice?\n                        <div style={styles.mainHeader}>\n                            <i className=\"left\" onClick={this.clearActive} style={{...styles.arrow}}></i>\n                            <i className=\"fa fa-download download-btn\" onClick={this.onDownloadMain}></i>\n                        </div>:null}\n                </header>\n                {\n                    crrInvoice ? \n                    <div style={styles.mainPadding}>\n                        <Document file={crrInvoice} onLoadSuccess={this.onDocumentLoadSuccess}>\n                        {\n                            Array.from(\n                            new Array(numOfPages),\n                            (el, index) => (\n                                <Page\n                                key={`page_${index + 1}`}\n                                pageNumber={index + 1}\n                                />\n                            ),\n                            )\n                        }\n                        </Document>\n                    </div>\n                    :\n                    invoices.length > 0?\n                    <div style={styles.mainPadding}>\n                        <div style={styles.mainTable}>\n                            <DataTable\n                                columns={columns}\n                                data={invoices? invoices:[]}\n                                onRowClicked={this.setActive}\n                                pointerOnHover={true}\n                                highlightOnHover={true}\n                                noHeader={true}\n                            />\n                        </div>\n                    </div>\n                    :\n                    null\n                }\n\n            </div>\n        )\n    }\n  \n}\n\nexport default IndexPage;\n"],"sourceRoot":""}