(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{v1ff:function(e,t,n){"use strict";n.r(t);n("a1Th"),n("XfO3"),n("HEwt"),n("rE2o"),n("ioFf"),n("VRzm"),n("rGqo"),n("yt8O"),n("Btvt"),n("f3/d");var a=n("o0o1"),i=n.n(a),r=(n("ls82"),n("q1tI")),o=n.n(r),s=n("sBL/"),c=n.n(s),l=n("3r0M"),u=n("XyXI"),d=n("iUi7"),m=n("/Ina"),h=n("wX7S"),p=n("iY3s"),f=n("Skks"),y=n("Pr5a"),g=n("U5J5");function b(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function w(e,t,n,a,i,r,o){try{var s=e[r](o),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(a,i)}function k(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){w(r,a,i,o,s,"next",e)}function s(e){w(r,a,i,o,s,"throw",e)}o(void 0)}))}}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var S={mainPadding:{padding:"0px 2em"},mainSidePadding:{padding:"10px 2em"},mainPdf:{display:"flex",justifyContent:"center"},mainTable:{backgroundColor:"#fff",border:"1px solid #d8e2f0",borderRadius:"4px",boxShadow:"0 0 10px 0 rgba(19,29,41,.05)",position:"relative",padding:"0em 3em 2em"},backButton:{cusor:"pointer"},label:{fontWeight:"bold"}},T=function(e){var t,n;function a(){var t;return(t=e.call(this)||this).microsoftTeams&&t.microsoftTeams.initialize(),t.state={apiKey:"",adminId:"",admins:null,admin:null,contacts:null,contact:null,keys:[],isNew:!1,isOpen:!1},t.handleChange=t.handleChange.bind(E(t)),t.submit=t.submit.bind(E(t)),t.getOptions=t.getOptions.bind(E(t)),t.handleContact=t.handleContact.bind(E(t)),t.save=t.save.bind(E(t)),t.getAdmin=c()(t.getAdmin,2e3).bind(E(t)),t.handleToken=t.handleToken.bind(E(t)),t.handleAdmin=t.handleAdmin.bind(E(t)),t}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=a.prototype;return r.getAdmin=function(){var e=k(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:"administrations.json",key:t})});case 3:return n=e.sent,e.next=6,n.json();case 6:a=e.sent,console.log({json:a}),a.error?this.setState({admins:!1}):this.setState({admins:a}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),r.componentDidMount=function(){var e=this;this.microsoftTeams=window?window.microsoftTeams:null,this.microsoftTeams.initialize(),this.microsoftTeams.getContext(function(){var t=k(i.a.mark((function t(n){var a,r,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.tid,t.prev=1,t.next=4,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/key/"+a,{mode:"cors",method:"GET"});case 4:return r=t.sent,t.next=7,r.json();case 7:o=t.sent,console.log({json:o}),e.setState({keys:o.map((function(e){return e.key}))}),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),console.log("BOOMER!"),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e){return t.apply(this,arguments)}}().bind(this))},r.getOptions=function(){return this.state.contacts.map((function(e){return{content:e.company_name,value:e.id}}))},r.handleContact=function(e,t){this.setState({contact:t.value},this.save)},r.handleAdmin=function(e,t){this.setState({admin:t.value}),this.submit(t.value)},r.handleChange=function(e){var t;this.setState(((t={})[e.target.name]=e.target.value,t))},r.handleToken=function(e,t){console.log({e:e,v:t}),e?(this.setState({apiKey:e.target.value,isOpen:!0}),this.getAdmin(e.target.value)):t&&(this.setState({apiKey:t.value,isOpen:!1}),this.getAdmin(t.value))},r.submit=function(){var e=k(i.a.mark((function e(t){var n,a,r,o,s=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.value,console.log(n),a=this.state,r=a.apiKey,o=a.isNew,this.microsoftTeams.initialize(),this.microsoftTeams.getContext(function(){var e=k(i.a.mark((function e(t){var a,c,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.tid,e.prev=1,e.next=4,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:n+"/contacts.json",key:r,tid:a,isNew:o})});case 4:return c=e.sent,e.next=7,c.json();case 7:l=e.sent,console.log({json:l}),s.setState({contacts:l}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.log("BOOM!"),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.save=function(){var e=this,t=this.state,n=t.apiKey,a=t.admin.value,i=t.contact;this.microsoftTeams.initialize(),this.microsoftTeams.settings.setValidityState(!0),this.microsoftTeams.settings.registerOnSaveHandler((function(t){e.microsoftTeams.settings.setSettings({websiteUrl:"https://jp5525.github.io/teams-demo/nl/",contentUrl:"https://jp5525.github.io/teams-demo/nl/",entityId:JSON.stringify({apiKey:n,adminId:a,contact:i}),suggestedDisplayName:"MoneyBird Invoices"}),t.notifySuccess()}))},r.render=function(){var e=this,t=this.state,n=t.contacts,a=t.contact,i=t.admins,r=t.admin,s=t.apiKey,c=t.keys,v=t.isOpen;return console.log({keys:c}),o.a.createElement(l.a,{theme:u.themes.teams},o.a.createElement("div",{style:S.mainPadding},o.a.createElement("div",{style:S.mainTable},o.a.createElement(d.a,{content:"MoneyBird Opstelling"}),o.a.createElement(m.a,{gap:"gap.small",vAlign:"center",hAlign:"start"},o.a.createElement(h.a,{justifyContent:"center"},o.a.createElement("form",{onSubmit:this.submit,style:{width:"100%"}},o.a.createElement("label",{style:S.label},"API Token")," ",o.a.createElement("br",null),o.a.createElement("span",null,"TDit is het API-token voor u MoneyBird-account. Je kunt er een genereren ",o.a.createElement("a",{target:"_blank",href:"https://moneybird.com/user/applications/new"},"hier")," voor persoonlijk gebruik."),0==i?o.a.createElement(o.a.Fragment,null," ",o.a.createElement("br",null),o.a.createElement(p.a,{content:"API-token niet geldig",icon:{as:y.a}})):null,i?o.a.createElement(o.a.Fragment,null," ",o.a.createElement("br",null),o.a.createElement(p.a,{content:"API-token IS geldig",icon:{as:g.a}})):null,o.a.createElement(f.a,{items:c,placeholder:"API Token",onChange:this.handleToken,name:"apiKey",id:"apiKey",clearable:s&&s.length>0,fluid:!0,search:!0,open:v,noResultsMessage:{content:"Add... "+s,onClick:function(t){e.setState({isNew:!0,keys:[s].concat(b(c)),isOpen:!1},e.getAdmin(s))},style:{cursor:"pointer"}}}),o.a.createElement("br",null),o.a.createElement("label",{style:S.label},"Toediening")," ",o.a.createElement("br",null),o.a.createElement("span",null,"Dit is de administratie van waaruit u contacten wilt bekijken"),o.a.createElement(f.a,{items:i?i.map((function(e){return{content:e.name,value:e.id}})):[],value:r?r.content:null,placeholder:"Administratie",onChange:this.handleAdmin,name:"Admin",disabled:!i,fluid:!0}),o.a.createElement("br",null),o.a.createElement("label",{style:S.label},"Contact")," ",o.a.createElement("br",null),o.a.createElement("span",null,"De contactpersoon wiens facturen verschijnen op de factuurtabs"),o.a.createElement(f.a,{items:n?this.getOptions():[],value:a?a.content:null,placeholder:"Contacts",onChange:this.handleContact,name:"contact",disabled:!n})))))))},a}(o.a.Component);t.default=T}}]);
//# sourceMappingURL=component---src-pages-nl-config-js-84c2caf9f2a93f24ee3f.js.map