(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"5H7b":function(e,t,a){"use strict";a.r(t);a("VRzm"),a("Btvt"),a("XfO3"),a("HEwt"),a("KKXr");var n=a("o0o1"),r=a.n(n),s=(a("ls82"),a("q1tI")),l=a.n(s),i=a("d76Q"),o=a.n(i),c=a("UsKZ"),u=a("Iab2"),d=a.n(u),m=a("kT3S"),f=(a("kpl1"),a("3r0M")),p=a("XyXI"),b=a("wXOM"),v=a("flNB"),h=a("xyxO");function y(e,t,a,n,r,s,l){try{var i=e[s](l),o=i.value}catch(c){return void a(c)}i.done?t(o):Promise.resolve(o).then(n,r)}function g(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var s=e.apply(t,a);function l(e){y(s,n,r,l,i,"next",e)}function i(e){y(s,n,r,l,i,"throw",e)}l(void 0)}))}}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}c.pdfjs.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/"+c.pdfjs.version+"/pdf.worker.js";var x={mainPadding:null,mainSidePadding:{padding:"15px 1em"},mainPdf:{display:"flex",justifyContent:"center",flexDirection:"column"},mainTable:{backgroundColor:"#fff",border:"1px solid #d8e2f0",borderRadius:"4px",boxShadow:"0 0 10px 0 rgba(19,29,41,.05)",position:"relative"},backButton:{cusor:"pointer"},arrow:{display:"inline-block",padding:"3px",cursor:"pointer"},download:{transform:"scale(1.5)",border:"none"},mainHeader:{display:"flex",justifyContent:"space-between"},table:{headCells:{style:{fontWeight:"bold"}},rows:{style:{"&:not(:last-of-type)":{borderBottomStyle:"solid",borderBottomWidth:"2px",borderBottomColor:"#F2F2F2"}}}}},E=function(e,t,a){return new Intl.NumberFormat(e,{style:"currency",currency:t}).format(a)},N={en:{tableHeadings:{invoiceId:"Quote id",reference:"Reference",date:"Quote date",amount:"Amount",status:"Status"},statuses:{open:l.a.createElement("div",{className:"state-label state-label--full-width state-label--warning"},l.a.createElement("span",{className:"state-label__text"},"open")),draft:l.a.createElement("div",{className:"state-label state-label--full-width state-label--warning"},l.a.createElement("span",{className:"state-label__text"},"draft")),paid:l.a.createElement("div",{className:"state-label state-label--full-width state-label--paid"},l.a.createElement("span",{className:"state-label__text"},"paid")),late:l.a.createElement("div",{className:"state-label state-label--full-width state-label--late"},l.a.createElement("span",{className:"state-label__text"},"late"))},payLabel:function(e,t,a){return l.a.createElement("span",null,"Amount payable: ",E(e,t,a))},payButton:"Approve"},nl:{tableHeadings:{invoiceId:"Offertenummer",reference:"Kenmerk",date:"Offertedatum",amount:"Bedrag",status:"Status"},statuses:{draft:l.a.createElement("div",{className:"state-label state-label--full-width state-label--warning"},l.a.createElement("span",{className:"state-label__text"},"Openstaand")),open:l.a.createElement("div",{className:"state-label state-label--full-width state-label--warning"},l.a.createElement("span",{className:"state-label__text"},"Verlopen")),paid:l.a.createElement("div",{className:"state-label state-label--full-width state-label--paid"},l.a.createElement("span",{className:"state-label__text"},"Betaald")),late:l.a.createElement("div",{className:"state-label state-label--full-width state-label--late"},l.a.createElement("span",{className:"state-label__text"},"Laat"))},payLabel:function(e,t,a){return l.a.createElement("span",null,"Te betalen bedrag: ",E(e,t,a))},payButton:"Goedkeuren"}},O=function(e,t){var a=new Blob([e],{type:"application/pdf"});d.a.saveAs(a,t)},S=function(e){var t,a;function n(){var t,a;return(a=e.call(this)||this).state=((t={quotes:[],crrQuote:null,apiKey:null,adminId:null,crrRow:null,loading:!0,numOfPages:null,locale:null}).crrQuote=null,t),a.setActive=a.setActive.bind(w(a)),a.clearActive=a.clearActive.bind(w(a)),a.onDownloadMain=a.onDownloadMain.bind(w(a)),a.fetchPdf=a.fetchPdf.bind(w(a)),a.onDocumentLoadSuccess=a.onDocumentLoadSuccess.bind(w(a)),a}a=e,(t=n).prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a;var s=n.prototype;return s.fetchPdf=function(){var e=g(r.a.mark((function e(t){var a,n,s,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.state,n=a.apiKey,s=a.adminId,e.next=3,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:s+"/estimates/"+t+"/download_pdf.json",key:n})});case 3:return l=e.sent,e.next=6,l.arrayBuffer();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.setActive=function(){var e=g(r.a.mark((function e(t,a){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,this.fetchPdf(t.id);case 3:n=e.sent,this.setState({crrQuote:n,crrRow:t,loading:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(t,a){return e.apply(this,arguments)}}(),s.onDownloadMain=function(){var e=this.state,t=e.crrInvoice,a=e.crrRow;O(t,a.estimate_id+".pdf")},s.onDownloadRow=function(){var e=g(r.a.mark((function e(t){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,this.fetchPdf(t.id);case 3:a=e.sent,this.setState({loading:!1}),O(a,t.invoice_id+".pdf");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.clearActive=function(){this.setState({crrQuote:null})},s.onDocumentLoadSuccess=function(e){var t=e.numPages;this.setState({numOfPages:t})},s.componentDidMount=function(){var e=this;this.microsoftTeams=window?window.microsoftTeams:null,this.microsoftTeams&&(this.microsoftTeams.initialize(),this.microsoftTeams.getContext(function(){var t=g(r.a.mark((function t(a){var n,s,l,i,o,c,u,d,m;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.entityId,s=a.locale,l=a.suggestedDisplayName,console.log({suggestedDisplayName:l}),i=JSON.parse(n),o=i.apiKey,c=i.adminId,u=i.contact.value,t.next=5,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:c+"/estimates.json?filter=contact_id:"+u,key:o})});case 5:return d=t.sent,t.next=8,d.json();case 8:m=t.sent,e.setState({quotes:m,adminId:c,apiKey:o,loading:!1,locale:s});case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))},s.render=function(){var e=this,t=this.state,a=t.quotes,n=t.crrQuote,r=t.loading,s=t.numOfPages,i=t.locale,u=t.crrRow;if(!i)return l.a.createElement(m.a,{loading:r});var d=N[i.split("-")[0]];if(!d)return l.a.createElement("p",null,"Sorry, it doesnt look like we have a translation for ",i.split("-")[0]);var y=[{name:d.tableHeadings.invoiceId,selector:"estimate_id",sortable:!0},{name:d.tableHeadings.reference,selector:"reference",sortable:!0},{name:d.tableHeadings.date,selector:"estimate_date",sortable:!0,maxWidth:"15%",minWidth:"100px"},{name:d.tableHeadings.amount,selector:"total_price_incl_tax_base",sortable:!0,maxWidth:"12%",minWidth:"125px",right:!0,cell:function(e){var t=e.total_price_incl_tax,a=e.currency;return E(i,a,t)}},{name:d.tableHeadings.status,selector:"state",sortable:!0,width:"10%",cell:function(e){return d.statuses[e.state]}},{name:"Download",maxWidth:"2%",center:!0,ignoreRowClick:!0,cell:function(t){return l.a.createElement(v.a,{style:{width:"32px"},onClick:function(){return e.onDownloadRow(t)}})}}];return l.a.createElement(f.a,{theme:p.themes.teams},n?l.a.createElement("div",{style:x.mainPdf},l.a.createElement("div",{style:{margin:"auto",width:"595px",marginBottom:"15px",display:"flex",justifyContent:"space-between"}},l.a.createElement("div",null,l.a.createElement(b.a,{primary:!0,circular:!0,icon:{as:h.a},styles:{fill:"white",width:"16px"},onClick:this.clearActive}),l.a.createElement(b.a,{primary:!0,circular:!0,icon:{as:v.a},styles:{fill:"white",marginLeft:"5px",width:"16px"},onClick:this.onDownloadMain})),"paid"!=u.state?l.a.createElement("div",{style:x.mainPdf},l.a.createElement("a",{href:u.url,target:"_blank",style:{textAlign:"center"}},l.a.createElement(b.a,{size:"large",style:{backgroundColor:"#38B8A0",color:"white"},content:d.payButton}))):null,l.a.createElement("div",null,d.statuses[u.state])),l.a.createElement("div",{style:{margin:"auto"}},l.a.createElement(c.Document,{file:n,onLoadSuccess:this.onDocumentLoadSuccess},Array.from(new Array(s),(function(e,t){return l.a.createElement(c.Page,{key:"page_"+(t+1),pageNumber:t+1})}))))):a.length>0?l.a.createElement("div",{style:x.mainPadding},l.a.createElement("div",{style:x.mainTable},l.a.createElement(m.a,{loading:r,style:{zIndex:100}}),l.a.createElement(o.a,{columns:y,data:a||[],onRowClicked:this.setActive,pointerOnHover:!0,highlightOnHover:!0,noHeader:!0,customStyles:x.table}))):null)},n}(l.a.Component);t.default=S},"Z+mF":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var n={filled:"ui-icon__filled",outline:"ui-icon__outline"}},flNB:function(e,t,a){"use strict";var n=a("q1tI"),r=a("TSYQ"),s=a.n(r),l=a("tIxt"),i=a("Z+mF"),o=Object(l.a)({svg:function(e){var t=e.classes;return n.createElement("svg",{role:"presentation",focusable:"false",viewBox:"8 8 16 16",className:t.svg},n.createElement("path",{className:s()(i.a.outline,t.outlinePart),d:"M20.1 16.6L17 19.8V9.5c0-.8-1-.8-1 0v10.3l-3.1-3.1c-.5-.5-1.2.2-.7.7l4 4c.2.2.6.1.7 0l4-4c.5-.7-.4-1.3-.8-.8zM21 24h-9c-.3 0-.5-.2-.5-.5s.2-.5.5-.5h9c.3 0 .5.2.5.5s-.2.5-.5.5z"}),n.createElement("path",{className:s()(i.a.filled,t.filledPart),d:"M21 23h-9c-.28 0-.5.22-.5.5s.22.5.5.5h9c.28 0 .5-.22.5-.5s-.22-.5-.5-.5zm-5.21-1.29c.2.2.45.29.71.29s.51-.1.71-.29l4-4a.996.996 0 1 0-1.41-1.41l-2.29 2.29V9.5c0-.55-.45-1-1-1s-1 .45-1 1v9.09l-2.29-2.29a.996.996 0 1 0-1.41 1.41l3.98 4z"}))},displayName:"DownloadIcon"});t.a=o},tIxt:function(e,t,a){"use strict";a("91GP");var n=a("KQm4"),r=a("q1tI"),s=a("AMYI"),l=(a("DNiP"),a("rGqo"),a("yt8O"),a("Btvt"),a("RW0V"),a("Ff2n")),i=a("U8pU"),o=(a("7GkX"),a("3WF5"),a("v8eK"),a("QkVN")),c=a.n(o),u=a("bNQv"),d=a.n(u),m=function(e){return function(){return"function"==typeof e?e.apply(void 0,arguments):e}},f=(a("0l/t"),a("8+KV"),a("LK8F"),function(e){return null!==e&&"object"===Object(i.a)(e)&&!Array.isArray(e)}),p=function(){for(var e=function e(t,a){return Object.keys(a).forEach((function(n){f(a[n])?(f(t[n])||(t[n]={}),e(t[n],a[n])):t[n]=a[n]})),t},t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return a.filter(Boolean).reduce((function(t,a){return e(t,a)}),{})},b=(a("HAE/"),function(e,t){return e}),v={siteVariables:{fontSizes:{}},componentVariables:{},componentStyles:{},fontFaces:[],staticStyles:[],animations:{}},h=function(){for(var e={},t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return a.reduce((function(e,t){return d()(t,(function(t,a){var n=e[a],r=t;null==r||"object"===Object(i.a)(r)&&0===Object.keys(r).length||(e[a]=void 0!==n?function(e){return c()(n(e),m(r)(e))}:m(r))})),e}),e)},y=h,g=function(){for(var e=function(){return{}},t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return a.reduce((function(e,t){return function(){var a=e.apply(void 0,arguments),n=m(t).apply(void 0,arguments);return p(a,n)}}),e)},w=g,x=(a("E+oP"),a("k4Da"),a("bWfx"),a("XfO3"),a("EK0E"),new WeakMap),E=function(e,t,a,r){var s,l=e.filter((function(e){return!!t.componentVariables[e]}));if(r){x.has(t)||x.set(t,{});var i=x.get(t)||{},o=l[l.length-1];i[o]||(i[o]=w.apply(void 0,Object(n.a)(l.map((function(e){return t.componentVariables[e]}))))(t.siteVariables),x.set(t,i)),s=i[o]}else s=1===l.length?m(t.componentVariables[l[0]])(t.siteVariables)||{}:w.apply(void 0,Object(n.a)(l.map((function(e){return t.componentVariables[e]}))))(t.siteVariables);return void 0===a?s:w(s,b(a,"props.variables"))(t.siteVariables)},N=a("rePB"),O=a("YO3V"),S=a.n(O),j=a("TSYQ"),P=a.n(j),_=new WeakMap,k=new WeakMap,A=function(e,t,a){var r=e.className,s=e.theme,i=e.displayNames,o=e.props,c=e.rtl,u=e.disableAnimations,d=e.renderer,m=e.performance,f=o.className,p=o.design,v=o.styles,h=o.variables,g=Object(l.a)(o,["className","design","styles","variables"]),w=!(p||v),x=m.enableBooleanVariablesCaching||!h;m.enableBooleanVariablesCaching&&(S()(h)&&Object.keys(h).every((function(e){return null===h[e]||void 0===h[e]||"boolean"==typeof h[e]}))||(x=!1));var E,O=m.enableStylesCaching&&w&&x;if(1===i.length)E=s.componentStyles[i[0]]||{root:function(){return{}}};else{var j=i.map((function(e){return s.componentStyles[e]})).filter(Boolean);E=j.length>0?y.apply(void 0,Object(n.a)(j)):{root:function(){return{}}}}w||(E=y(E,o.design&&b({root:o.design},"props.design"),o.styles&&b({root:o.styles},"props.styles")));var A={props:o,variables:t,theme:s,rtl:c,disableAnimations:u},C={theme:{direction:c?"rtl":"ltr"},disableAnimations:u,displayName:i.join(":"),sanitizeCss:m.enableSanitizeCssPlugin},B=a||function(e){return d.renderRule((function(){return e}),C)},I={},V={};O&&s&&(k.has(s)||k.set(s,{}),_.has(s)||_.set(s,{}));var D=O?JSON.stringify(g):"",T=O&&m.enableBooleanVariablesCaching?JSON.stringify(h):"",z=O?"".concat(i.join(":"),":").concat(D,":").concat(T,":").concat(A.rtl).concat(A.disableAnimations):"";return Object.keys(E).forEach((function(e){var t="".concat(e,"__return"),a=z+e;Object.defineProperty(I,e,{enumerable:!1,configurable:!1,set:function(e){O&&s&&k.set(s,Object.assign({},k.get(s),Object(N.a)({},a,e))),I[t]=e},get:function(){if(O&&s){var n=k.get(s)||{};if(n[a])return n[a]}return I[t]||(I[t]=E[e](A),O&&s&&k.set(s,Object.assign({},k.get(s),Object(N.a)({},a,I[t])))),I[t]}}),Object.defineProperty(V,e,{enumerable:!1,configurable:!1,set:function(e){O&&s&&_.set(s,Object.assign({},_.get(s),Object(N.a)({},a,e))),V[t]=e},get:function(){if(O&&s){var n=_.get(s)||{};if(n[a]||""===n[a])return"root"===e?P()(r,n[a],f):n[a]}if(V[t])return"root"===e?P()(r,V[t],f):V[t];var l=I[e];return B&&l&&(V[t]=B(l),O&&s&&_.set(s,Object.assign({},_.get(s),Object(N.a)({},a,V[t])))),"root"===e?P()(r,V[t],f):V[t]}})})),{resolvedStyles:I,resolvedStylesDebug:{},classes:V}},C=function(e){var t=E(e.displayNames,e.theme,e.props.variables,e.performance.enableVariablesCaching),a=A(e,t),n=a.classes,r=a.resolvedStyles;a.resolvedStylesDebug;return{classes:n,variables:t,styles:r,theme:e.theme}},B={rtl:!1,disableAnimations:!1,performance:{enableSanitizeCssPlugin:!1,enableStylesCaching:!0,enableVariablesCaching:!0,enableBooleanVariablesCaching:!1},renderer:{renderRule:function(){return""}},theme:v},I=function(e,t){var a,n=r.useContext(s.b)||B,l=t.className,i=void 0===l?"":l,o=t.composeOptions,c=t.mapPropsToStyles,u=void 0===c?function(){return{}}:c,d=t.mapPropsToInlineStyles,m=void 0===d?function(){return{}}:d,f=t.unstable_props,p=void 0===f?{}:f,b=t.rtl,v=void 0!==b&&b,h=u(),y=Object.assign({},p,{},h),g=null==o||null===(a=o.mapPropsToStylesPropsChain)||void 0===a?void 0:a.reduce((function(e,t){return Object.assign({},e,{},t(y))}),{}),w=r.useRef({fluentUIDebug:null}),x=C({className:(null==o?void 0:o.className)||i,displayNames:(null==o?void 0:o.displayNames)||[e],props:Object.assign({},h,{},m(),{},g),disableAnimations:n.disableAnimations,renderer:n.renderer,rtl:v,saveDebug:function(e){return w.current={fluentUIDebug:e}},theme:n.theme,performance:n.performance});return{classes:x.classes,styles:x.styles}};a("V+eJ");var V=function(e,t){return Object.keys(t).reduce((function(a,n){return-1===e.indexOf(n)&&(a[n]=t[n]),a}),{})},D=["bordered","className","circular","design","disabled","outline","size","rotate","styles","variables","xSpacing"];t.a=function(e){var t=e.svg,a=e.displayName,l=e.handledProps,i=void 0===l?[]:l,o=function(e){var a=r.useContext(s.b),l=e.alt,o=e["aria-label"],c=e.bordered,u=e.circular,d=e.className,m=e.design,f=e.disabled,p=e.outline,b=e.rotate,v=void 0===b?0:b,h=e.size,y=void 0===h?"medium":h,g=e.styles,w=e.variables,x=e.xSpacing,E=I("SvgIcon",{className:"ui-icon",mapPropsToStyles:function(){return{bordered:c,circular:u,disabled:f,outline:p,rotate:v,size:y,xSpacing:x}},mapPropsToInlineStyles:function(){return{className:d,design:m,styles:g,variables:w}},rtl:a.rtl}).classes,N=V([].concat(D,Object(n.a)(i)),e);return r.createElement("span",Object.assign({role:"img","aria-hidden":l||o?void 0:"true","aria-label":o,className:E.root},N),t({classes:E,rtl:a.rtl,props:e}))};return o.displayName=a,o.handledProps=[].concat(D,Object(n.a)(i)),o}},xyxO:function(e,t,a){"use strict";var n=a("q1tI"),r=a("TSYQ"),s=a.n(r),l=a("tIxt"),i=a("Z+mF"),o=Object(l.a)({svg:function(e){var t=e.classes;return n.createElement("svg",{role:"presentation",focusable:"false",viewBox:"8 8 16 16",className:t.svg},n.createElement("g",null,n.createElement("path",{className:s()(i.a.outline,t.outlinePart),d:"M19 22.97c0 .14-.05.25-.15.35a.485.485 0 0 1-.7 0l-7-7a.485.485 0 0 1 0-.7l7-7a.485.485 0 0 1 .7 0c.1.1.15.21.15.35 0 .14-.05.25-.15.35l-6.64 6.65 6.64 6.65c.1.1.15.21.15.35z"}),n.createElement("path",{className:s()(i.a.filled,t.filledPart),d:"M19.5 8.97c0 .14-.03.27-.07.39-.05.12-.12.23-.21.32l-6.3 6.29 6.3 6.29c.09.09.17.2.21.32a1.036 1.036 0 0 1-.01.77c-.05.12-.13.23-.22.32s-.2.16-.32.22a.995.995 0 0 1-1.09-.21l-7-7c-.19-.19-.29-.43-.29-.71s.1-.52.29-.71l7-7a.995.995 0 0 1 1.09-.21c.12.06.23.13.32.22s.16.2.22.32c.05.12.08.25.08.38z"})))},displayName:"ChevronStartIcon"});t.a=o}}]);
//# sourceMappingURL=component---src-pages-quotes-js-e8a05378cc88fb009833.js.map