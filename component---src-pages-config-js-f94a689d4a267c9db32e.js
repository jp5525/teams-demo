(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{jFQB:function(e,t,n){"use strict";n("91GP");var a=n("wx14"),o=n("1OyB"),r=n("vuIU"),i=n("md7G"),s=n("foSv"),c=n("JX7q"),l=n("Ji7U"),u=n("rePB"),d=n("3WF5"),p=n.n(d),m=n("Og4/"),h=n.n(m),f=n("UfWW"),y=n.n(f),b=n("R2a4"),g=function(){return{attributes:{root:{role:"radiogroup"}},keyActions:{root:{nextItem:{keyCombinations:[{keyCode:b.ArrowDown},{keyCode:b.ArrowRight}]},prevItem:{keyCombinations:[{keyCode:b.ArrowUp},{keyCode:b.ArrowLeft}]}}}}},v=n("LfD4"),k=n("17x9"),w=n("q1tI"),O=n("4o4N"),C=n("Gk4L"),S=n("oPHA"),j=n("+3zh"),E=n("7X27"),T=n("3LPQ"),x=n("ihDb"),I=function(e){function t(){var e,n;Object(o.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return n=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r))),Object(u.a)(Object(c.a)(n),"actionHandlers",{nextItem:function(e){return n.setCheckedItem(e,1)},prevItem:function(e){return n.setCheckedItem(e,-1)}}),Object(u.a)(Object(c.a)(n),"getItemProps",(function(e){return e.props||e})),Object(u.a)(Object(c.a)(n),"setCheckedItem",(function(e,t){var a=n.findNextEnabledCheckedItem(t);a&&n.setCheckedValue({checkedValue:a.value,shouldFocus:!0,event:e,props:a}),e.preventDefault()})),Object(u.a)(Object(c.a)(n),"findNextEnabledCheckedItem",(function(e){if(n.props.items&&n.props.items.length)for(var t=void 0!==n.state.checkedValue?y()(n.props.items,(function(e){return n.getItemProps(e).value===n.state.checkedValue})):0,a=t+e;a!==t;a+=e){if(a<0?a=n.props.items.length-1:a>=n.props.items.length&&(a=0),a===t)return;var o=n.getItemProps(n.props.items[a]);if(!o.disabled)return o}})),Object(u.a)(Object(c.a)(n),"handleItemOverrides",(function(e){return{checked:void 0!==n.state.checkedValue&&n.state.checkedValue===e.value,onClick:function(t,a){var o=a.value;a.disabled||o===n.state.checkedValue||n.setCheckedValue({checkedValue:o,shouldFocus:!1,event:t,props:a}),h()(e,"onClick",t,a)},shouldFocus:n.state.shouldFocus}})),Object(u.a)(Object(c.a)(n),"renderItems",(function(e){var a=n.props.items,o=void 0===n.state.checkedValue;return p()(a,(function(a,r){return T.a.create(a,{defaultProps:function(){return Object.assign({className:t.slotClassNames.item,vertical:e},0===r&&o&&{tabIndex:0})},overrideProps:n.handleItemOverrides})}))})),n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"renderComponent",value:function(e){var t=e.ElementType,n=e.classes,o=e.accessibility,r=e.unhandledProps,i=this.props,s=i.children,c=i.vertical;return w.createElement(t,Object(a.a)({},o.attributes.root,O.a.getAttributes({forElements:[s]}),r,Object(C.a)(o.keyHandlers.root,r),{className:n.root}),Object(S.a)(s)?s:this.renderItems(c))}},{key:"setCheckedValue",value:function(e){var t=e.checkedValue,n=e.shouldFocus,a=e.event,o=e.props;this.setState({checkedValue:t,shouldFocus:n}),h()(this.props,"onCheckedValueChange",a,o)}}]),t}(j.a);Object(u.a)(I,"displayName","RadioGroup"),Object(u.a)(I,"className","ui-radiogroup"),Object(u.a)(I,"slotClassNames",{item:"".concat(I.className,"__item")}),Object(u.a)(I,"create",void 0),Object(u.a)(I,"propTypes",Object.assign({},E.commonPropTypes.createCommon({content:!1}),{checkedValue:k.oneOfType([k.number,k.string]),defaultCheckedValue:k.oneOfType([k.number,k.string]),items:v.c,onCheckedValueChange:k.func,vertical:k.bool})),Object(u.a)(I,"defaultProps",{as:"div",accessibility:g}),Object(u.a)(I,"autoControlledProps",["checkedValue"]),Object(u.a)(I,"Item",T.a);t.a=Object(x.a)(I)},kQFk:function(e,t,n){"use strict";n.r(t);n("f3/d"),n("a1Th"),n("XfO3"),n("HEwt"),n("rE2o"),n("ioFf"),n("VRzm"),n("rGqo"),n("yt8O"),n("Btvt"),n("KKXr");var a=n("o0o1"),o=n.n(a),r=(n("ls82"),n("q1tI")),i=n.n(r),s=n("3r0M"),c=n("XyXI"),l=n("iUi7"),u=n("/Ina"),d=n("wX7S"),p=n("iY3s"),m=n("Skks"),h=n("wXOM"),f=n("WZt7"),y=n("jFQB");function b(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function v(e,t,n,a,o,r,i){try{var s=e[r](i),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(a,o)}function k(e){return function(){var t=this,n=arguments;return new Promise((function(a,o){var r=e.apply(t,n);function i(e){v(r,a,o,i,s,"next",e)}function s(e){v(r,a,o,i,s,"throw",e)}i(void 0)}))}}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var O=function(e){return null==e||0==e.length},C={mainPadding:{padding:"0px 2em"},mainSidePadding:{padding:"10px 2em"},mainPdf:{display:"flex",justifyContent:"center"},mainTable:{backgroundColor:"#fff",border:"1px solid #d8e2f0",borderRadius:"4px",boxShadow:"0 0 10px 0 rgba(19,29,41,.05)",position:"relative",padding:"0em 3em 2em"},backButton:{cusor:"pointer"},label:{fontWeight:"bold"}},S={en:{heading:"Moneybird Configuration",apiSection:{title:i.a.createElement("label",{style:C.label},"API Token"),description:i.a.createElement("span",null,"This is the API Token for you MoneyBird Account. You can generate one ",i.a.createElement("a",{target:"_blank",href:"https://moneybird.com/user/applications/new"},"here")," for personal use."),succsess:"API Token is vaild",fail:"API Token NOT vaild",placeholder:"API Token",show:"Click to choose another api key"},contactSection:{title:i.a.createElement("label",{style:C.label},"Contact"),description:i.a.createElement("span",null,"The contact whos data will show up on the tab"),placeholder:"Choose a Contact"},typeSection:{title:i.a.createElement("label",{style:C.label},"Data Type"),description:i.a.createElement("span",null,"The type of data to show on the tab")},deleteDialog:{cancel:"Cancel",confirm:"Yes",header:"Delete API Key",message:function(e){return"Are you sure you want to delete "+e}},tabs:["Invoices","Quotes"]},nl:{heading:"Moneybird Koppelen",apiSection:{title:i.a.createElement("label",{style:C.label},"API token invoeren"),description:i.a.createElement("span",null,"Vul hier een API-token in van je Moneybird account. Je kunt ",i.a.createElement("a",{target:"_blank",href:"https://moneybird.com/user/applications/new"},"hier")," een API-token genereren. Vul een naam in die herkenbaar is voor deze connectie, bijvoorbeeld ‘Microsoft Teams Integratie’. Kies voor ‘API token voor persoonlijk gebruik’ en geef toegang voor alle onderdelen. Vervolgens verschijnt er een API-token in beeld. Vul deze hieronder in."),succsess:"API-token is geldig",fail:"API-token niet geldig",placeholder:"API token invoeren",show:"Klik om een ​​andere API-sleutel te kiezen"},contactSection:{title:i.a.createElement("label",{style:C.label},"Contact"),description:i.a.createElement("span",null,"Selecteer de Contact waarvan je de gegevens wilt tonen in de Tab."),placeholder:"Kies een Contact"},typeSection:{title:i.a.createElement("label",{style:C.label},"Data Type"),description:i.a.createElement("span",null,"Het type gegevens dat op het tabblad moet worden weergegeven")},deleteDialog:{cancel:"Annuleren",confirm:"Ja",header:"API-sleutel verwijderen",message:function(e){return"Weet je zeker dat je wilt verwijderen "+e}},tabs:["Facturen","Offertes"]}},j=function(e){var t,n;function a(){var t;return(t=e.call(this)||this).microsoftTeams&&t.microsoftTeams.initialize(),t.state={apiKey:null,adminId:null,admins:null,admin:null,contacts:null,contact:null,loadingContacts:!1,keys:[],isNew:!1,isOpen:!1,isContactsOpen:!1,locale:null,tabType:"invoices",showApiKeys:!1,loaded:!1},t.submit=t.submit.bind(w(t)),t.getOptions=t.getOptions.bind(w(t)),t.save=t.save.bind(w(t)),t.getAdmin=t.getAdmin.bind(w(t)),t.handleToken=t.handleToken.bind(w(t)),t.handleAdmin=t.handleAdmin.bind(w(t)),t.getContacts=t.getContacts.bind(w(t)),t.updateContact=t.updateContact.bind(w(t)),t.deleteKeyFromDb=t.deleteKeyFromDb.bind(w(t)),t.createKeyEntry=t.createKeyEntry.bind(w(t)),t}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var r=a.prototype;return r.getAdmin=function(){var e=k(o.a.mark((function e(t,n){var a,r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=!1),a=this.state.tid,e.prev=2,e.next=5,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:"administrations.json",key:t,isNew:n,tid:a})});case 5:return r=e.sent,e.next=8,r.json();case 8:i=e.sent,console.log({json:i}),i.error?this.setState({admins:!1,isOpen:!1,contacts:null}):(this.setState({admin:i[0],adminId:i[0].id,admins:!0,isOpen:!1}),this.submit(i[0])),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),console.log(e.t0);case 16:case"end":return e.stop()}}),e,this,[[2,13]])})));return function(t,n){return e.apply(this,arguments)}}(),r.componentDidMount=function(){var e=k(o.a.mark((function e(){var t=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.microsoftTeams=window?window.microsoftTeams:null,this.microsoftTeams.initialize(),this.microsoftTeams.getContext(function(){var e=k(o.a.mark((function e(n){var a,r,s,c,l,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.tid,r=n.locale,e.prev=1,e.next=4,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/key/"+a,{mode:"cors",method:"GET"});case 4:return s=e.sent,e.next=7,s.json();case 7:c=e.sent,console.log({json:c}),l=c.map((function(e){return{content:i.a.createElement("div",null,i.a.createElement("span",{style:{cursor:"pointer"},class:"lnr lnr-trash",onClick:function(){return t.setState({deleteKey:e.key,isOpen:!1})}})," - ",i.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return t.handleToken(e.key)}},e.key)),key:e.key}})),u=c[0].key,d=O(u),t.setState({keys:l,apiKey:u,showApiKeys:d,tid:a,locale:r}),0==d&&t.getAdmin(u),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(1),console.log("BOO"),console.log(e.t0);case 20:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}().bind(this));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.getOptions=function(){return this.state.contacts.map((function(e){return{content:e.company_name,value:e.id}}))},r.handleAdmin=function(e,t){this.setState({admin:t.value}),this.submit(t.value)},r.getContacts=function(){var e=k(o.a.mark((function e(t,n){var a,r,i,s,c,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=21;break}return a=this.state,r=a.apiKey,i=a.adminId,s=n.searchQuery,e.prev=3,this.setState({loadingContacts:!0}),e.next=7,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:i+"/contacts.json"+(O(s)?"":"?query="+s),key:r})});case 7:return c=e.sent,e.next=10,c.json();case 10:l=e.sent,console.log({json:l}),this.setState({contacts:l,loadingContacts:!1}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),console.log("BOOM!"),console.log(e.t0);case 19:e.next=22;break;case 21:this.setState({contact:t.value},this.save);case 22:case"end":return e.stop()}}),e,this,[[3,15]])})));return function(t,n){return e.apply(this,arguments)}}(),r.handleToken=function(e){this.setState({apiKey:e,isOpen:!1}),this.getAdmin(e)},r.submit=function(){var e=k(o.a.mark((function e(t){var n,a,r,i,s,c=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.id,console.log({adminId:n}),a=this.state,r=a.apiKey,i=a.isNew,s=a.loaded,this.microsoftTeams.initialize(),this.microsoftTeams.getContext(function(){var e=k(o.a.mark((function e(t){var a,l,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.tid,e.prev=1,e.next=4,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:n+"/contacts.json",key:r,tid:a,isNew:i})});case 4:return l=e.sent,e.next=7,l.json();case 7:u=e.sent,console.log({json:u}),c.setState({contacts:u,isOpen:!1}),0==s&&(c.microsoftTeams.appInitialization.notifyAppLoaded(),c.microsoftTeams.appInitialization.notifySuccess(),c.setState({loaded:!0})),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.log("BOOM!"),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}().bind(this));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.updateContact=function(e,t){var n=this,a=t.value;this.setState({contact:a},(function(){return n.save()}))},r.save=function(){var e=this,t=this.state,n=t.apiKey,a=t.adminId,o=t.contact,r=t.locale,i=t.tabType,s=r.split("-")[0];console.log({contact:o}),this.microsoftTeams.initialize(),this.microsoftTeams.settings.setValidityState(!0),this.microsoftTeams.settings.registerOnSaveHandler((function(t){e.microsoftTeams.settings.setSettings({websiteUrl:"invoices"==i?"https://jp5525.github.io/teams-demo/invoices":"https://jp5525.github.io/teams-demo/quotes",contentUrl:"invoices"==i?"https://jp5525.github.io/teams-demo/invoices":"https://jp5525.github.io/teams-demo/quotes",entityId:JSON.stringify({apiKey:n,adminId:a,contact:o}),suggestedDisplayName:"Moneybird "+("invoices"==i?S[s].tabs[0]:S[s].tabs[1])}),t.notifySuccess()}))},r.deleteKeyFromDb=function(){var e=k(o.a.mark((function e(){var t,n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state,n=t.deleteKey,a=t.keys,O(n)){e.next=5;break}return e.next=4,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/key/"+n,{mode:"cors",method:"DELETE"});case 4:this.setState({deleteKey:null,apiKey:"",keys:a.filter((function(e){return e.key!=n}))});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.createKeyEntry=function(e){var t=this;return{content:i.a.createElement("div",null,i.a.createElement("span",{style:{cursor:"pointer"},class:"lnr lnr-trash",onClick:function(){return t.setState({deleteKey:e})}})," - ",i.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return t.handleToken(e)}},e)),key:e}},r.render=function(){var e=this,t=this.state,n=t.contacts,a=t.contact,o=t.admins,r=(t.admin,t.apiKey),g=t.keys,v=t.isOpen,k=t.locale,w=t.loadingContacts,j=t.showApiKeys,E=t.deleteKey;console.log({locale:k});var T=k?S[k.split("-")[0]]:null,x=T?[{key:"invoices",value:"invoices",name:"invoices",label:T.tabs[0],onClick:function(){return e.setState({tabType:"invoices"})}},{key:"quotes",name:"quotes",value:"quotes",label:T.tabs[1],onClick:function(){return e.setState({tabType:"quotes"})}}]:null;return T?i.a.createElement(s.a,{theme:c.themes.teams},i.a.createElement("div",{style:C.mainPadding},i.a.createElement("div",{style:C.mainTable},i.a.createElement(l.a,{content:T.heading}),i.a.createElement(u.a,{gap:"gap.small",vAlign:"center",hAlign:"start"},i.a.createElement(d.a,{justifyContent:"center"},i.a.createElement("form",{onSubmit:this.submit,style:{width:"100%"}},T.apiSection.title," ",i.a.createElement("br",null),T.apiSection.description,0==o?i.a.createElement(i.a.Fragment,null," ",i.a.createElement("br",null),i.a.createElement(p.a,{content:T.apiSection.fail,style:{background:"#cc4a31",color:"white",marginTop:"10px",marginBottom:"10px"}})):null,o?i.a.createElement(i.a.Fragment,null," ",i.a.createElement("br",null),i.a.createElement(p.a,{content:T.apiSection.succsess,style:{background:"#7fba00",color:"white",marginTop:"10px",marginBottom:"10px"}})):null,j?i.a.createElement(m.a,{items:g,placeholder:T.apiSection.placeholder,onOpenChange:function(){return e.setState({isOpen:!v})},name:"apiKey",id:"apiKey",clearable:r&&r.length>0,fluid:!0,search:!0,open:v,searchQuery:r,itemToString:function(e){return e?e.key:null},onSearchQueryChange:function(t,n){return e.setState({apiKey:n.searchQuery})},noResultsMessage:{content:"Add... "+r,onClick:function(t){e.setState({isNew:!0,keys:[e.createKeyEntry(r)].concat(b(g)),isOpen:!1},(function(){return e.getAdmin(r,!0)}))},style:{cursor:"pointer"},active:!0}}):i.a.createElement("div",null,i.a.createElement(h.a,{text:!0,content:T.apiSection.show,onClick:function(){return e.setState({showApiKeys:!0})},style:{padding:"0px"}})),i.a.createElement(f.a,{cancelButton:T.deleteDialog.cancel,onCancel:function(){return e.setState({deleteKey:null})},confirmButton:T.deleteDialog.confirm,onConfirm:this.deleteKeyFromDb,content:T.deleteDialog.message(E),header:T.deleteDialog.header,open:!O(E),backdrop:!0}),i.a.createElement("br",null),T.contactSection.title," ",i.a.createElement("br",null),T.contactSection.description,i.a.createElement(m.a,{ref:function(t){return e.drop=t},items:n?this.getOptions():[],value:a?a.content:null,placeholder:T.contactSection.placeholder,search:!0,loading:w,loadingMessage:"Loading...",onSearchQueryChange:this.getContacts,onChange:this.updateContact,name:"contact",disabled:!n,itemToString:function(e){return e?e.content:""},fluid:!0}),i.a.createElement("br",null),T.typeSection.title," ",i.a.createElement("br",null),T.typeSection.description,i.a.createElement(y.a,{defaultCheckedValue:"invoices",items:x,onCheckedValueChange:function(t,n){e.setState({tabType:n.value},(function(){return e.save()}))},style:{margingTop:"5px"}}))))))):null},a}(i.a.Component);t.default=j}}]);
//# sourceMappingURL=component---src-pages-config-js-f94a689d4a267c9db32e.js.map