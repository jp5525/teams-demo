(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{kQFk:function(e,t,n){"use strict";n.r(t);n("VRzm"),n("Btvt"),n("f3/d");var a=n("o0o1"),i=n.n(a),o=(n("ls82"),n("q1tI")),r=n.n(o),s=n("sBL/"),l=n.n(s),c=n("3r0M"),d=n("XyXI"),m=n("iUi7"),u=n("/Ina"),h=n("wX7S"),p=n("iY3s"),f=n("KZyE"),b=n("Skks"),g=n("Pr5a"),y=n("U5J5");function v(e,t,n,a,i,o,r){try{var s=e[o](r),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(a,i)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function r(e){v(o,a,i,r,s,"next",e)}function s(e){v(o,a,i,r,s,"throw",e)}r(void 0)}))}}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var T={mainPadding:{padding:"0px 2em"},mainSidePadding:{padding:"10px 2em"},mainPdf:{display:"flex",justifyContent:"center"},mainTable:{backgroundColor:"#fff",border:"1px solid #d8e2f0",borderRadius:"4px",boxShadow:"0 0 10px 0 rgba(19,29,41,.05)",position:"relative",padding:"0em 3em 2em"},backButton:{cusor:"pointer"},label:{fontWeight:"bold"}},k=function(e){var t,n;function a(){var t;return(t=e.call(this)||this).microsoftTeams&&t.microsoftTeams.initialize(),t.state={apiKey:"",adminId:"",admins:null,admin:null,contacts:null,contact:null},t.handleChange=t.handleChange.bind(w(t)),t.submit=t.submit.bind(w(t)),t.getOptions=t.getOptions.bind(w(t)),t.handleContact=t.handleContact.bind(w(t)),t.save=t.save.bind(w(t)),t.getAdmin=l()(t.getAdmin,2e3).bind(w(t)),t.handleToken=t.handleToken.bind(w(t)),t.handleAdmin=t.handleAdmin.bind(w(t)),t}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=a.prototype;return o.getAdmin=function(){var e=E(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:"administrations.json",key:t})});case 3:return n=e.sent,e.next=6,n.json();case 6:a=e.sent,console.log({json:a}),a.error?this.setState({admins:!1}):this.setState({admins:a}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),o.componentDidMount=function(){this.microsoftTeams=window?window.microsoftTeams:null},o.getOptions=function(){return this.state.contacts.map((function(e){return{content:e.company_name,value:e.id}}))},o.handleContact=function(e,t){this.setState({contact:t.value},this.save)},o.handleAdmin=function(e,t){this.setState({admin:t.value}),this.submit(t.value)},o.handleChange=function(e){var t;this.setState(((t={})[e.target.name]=e.target.value,t))},o.handleToken=function(e){this.handleChange(e),this.getAdmin(e.target.value)},o.submit=function(){var e=E(i.a.mark((function e(t){var n,a,o,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.value,console.log(n),a=this.state.apiKey,e.prev=3,e.next=6,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:n+"/contacts.json",key:a})});case 6:return o=e.sent,e.next=9,o.json();case 9:r=e.sent,console.log({json:r}),this.setState({contacts:r}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),console.log("BOOM!"),console.log(e.t0);case 18:case"end":return e.stop()}}),e,this,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),o.save=function(){var e=this,t=this.state,n=t.apiKey,a=t.admin.value,i=t.contact;this.microsoftTeams.initialize(),this.microsoftTeams.settings.setValidityState(!0),this.microsoftTeams.settings.registerOnSaveHandler((function(t){e.microsoftTeams.settings.setSettings({websiteUrl:"https://jp5525.github.io/teams-demo",contentUrl:"https://jp5525.github.io/teams-demo",entityId:JSON.stringify({apiKey:n,adminId:a,contact:i}),suggestedDisplayName:"MoneyBird Invoices"}),t.notifySuccess()}))},o.render=function(){var e=this.state,t=e.contacts,n=e.contact,a=e.admins,i=e.admin;return r.a.createElement(c.a,{theme:d.themes.teams},r.a.createElement("div",{style:T.mainPadding},r.a.createElement("div",{style:T.mainTable},r.a.createElement(m.a,{content:"MoneyBird Setup"}),r.a.createElement(u.a,{gap:"gap.small",vAlign:"center",hAlign:"start"},r.a.createElement(h.a,{justifyContent:"center"},r.a.createElement("form",{onSubmit:this.submit,style:{width:"100%"}},r.a.createElement("label",{style:T.label},"API Token")," ",r.a.createElement("br",null),r.a.createElement("span",null,"This is the API Token for you MoneyBird Account. You can generate one ",r.a.createElement("a",{target:"_blank",href:"https://moneybird.com/user/applications/new"},"here")," for personal use."),0==a?r.a.createElement(r.a.Fragment,null," ",r.a.createElement("br",null),r.a.createElement(p.a,{content:"API Token not vaild",icon:{as:g.a}})):null,a?r.a.createElement(r.a.Fragment,null," ",r.a.createElement("br",null),r.a.createElement(p.a,{content:"API Token IS vaild",icon:{as:y.a}})):null,r.a.createElement(f.a,{type:"text",placeholder:"API Token",name:"apiKey",id:"apiKey",onChange:this.handleToken,fluid:!0})," ",r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("label",{style:T.label},"Administration")," ",r.a.createElement("br",null),r.a.createElement("span",null,"This is the administration you created your API Token for"),r.a.createElement(b.a,{items:a?a.map((function(e){return{content:e.name,value:e.id}})):[],value:i?i.content:null,placeholder:"Administrations",onChange:this.handleAdmin,name:"Admin",disabled:!a,fluid:!0}),r.a.createElement("br",null),r.a.createElement("label",{style:T.label},"Contact")," ",r.a.createElement("br",null),r.a.createElement("span",null,"The contact whos invoice's will show up on the invoices tabs"),r.a.createElement(b.a,{items:t?this.getOptions():[],value:n?n.content:null,placeholder:"Contacts",onChange:this.handleContact,name:"contact",disabled:!t})))))))},a}(r.a.Component);t.default=k}}]);
//# sourceMappingURL=component---src-pages-config-js-30bb18e8e07f8ae96c85.js.map