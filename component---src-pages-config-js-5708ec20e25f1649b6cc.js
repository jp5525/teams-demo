(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{kQFk:function(e,t,n){"use strict";n.r(t);n("a1Th"),n("XfO3"),n("HEwt"),n("rE2o"),n("ioFf"),n("VRzm"),n("rGqo"),n("yt8O"),n("Btvt"),n("KKXr"),n("f3/d");var a=n("o0o1"),i=n.n(a),o=(n("ls82"),n("q1tI")),r=n.n(o),s=n("sBL/"),l=n.n(s),c=n("3r0M"),d=n("XyXI"),u=n("iUi7"),m=n("/Ina"),p=n("wX7S"),h=n("iY3s"),f=n("Skks"),b=n("Pr5a"),y=n("U5J5");function g(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function k(e,t,n,a,i,o,r){try{var s=e[o](r),l=s.value}catch(c){return void n(c)}s.done?t(l):Promise.resolve(l).then(a,i)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function r(e){k(o,a,i,r,s,"next",e)}function s(e){k(o,a,i,r,s,"throw",e)}r(void 0)}))}}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var E={mainPadding:{padding:"0px 2em"},mainSidePadding:{padding:"10px 2em"},mainPdf:{display:"flex",justifyContent:"center"},mainTable:{backgroundColor:"#fff",border:"1px solid #d8e2f0",borderRadius:"4px",boxShadow:"0 0 10px 0 rgba(19,29,41,.05)",position:"relative",padding:"0em 3em 2em"},backButton:{cusor:"pointer"},label:{fontWeight:"bold"}},T={en:{apiSection:{title:r.a.createElement("label",{style:E.label},"API Token"),description:r.a.createElement("span",null,"This is the API Token for you MoneyBird Account. You can generate one ",r.a.createElement("a",{target:"_blank",href:"https://moneybird.com/user/applications/new"},"here")," for personal use."),succsess:"API Token IS vaild",fail:"API Token NOT vaild",placeholder:"API Token"},adminSection:{title:r.a.createElement("label",{style:E.label},"Administration"),description:r.a.createElement("span",null,"This is the administration you created your API Token for"),placeholder:"Administration"},contactSection:{title:r.a.createElement("label",{style:E.label},"Contact"),description:r.a.createElement("span",null,"The contact whos invoice's will show up on the invoices tabs"),placeholder:"Contact"},tabTitle:"Moneybird Invoices"},nl:{apiSection:{title:r.a.createElement("label",{style:E.label},"API token invoeren"),description:r.a.createElement("span",null,"Vul hier een API-token in van je Moneybird account. Je kunt ",r.a.createElement("a",{target:"_blank",href:"https://moneybird.com/user/applications/new"},"hier")," een API-token genereren. Vul een naam in die herkenbaar is voor deze connectie, bijvoorbeeld ‘Microsoft Teams Integratie’. Kies voor ‘API token voor persoonlijk gebruik’ en geef in ieder geval toegang voor alle onderdelen. Vervolgens verschijnt er een API-token in beeld. Vul deze hieronder in."),succsess:"API-token niet geldig",fail:"API-token IS geldig",placeholder:"API token invoeren"},adminSection:{title:r.a.createElement("label",{style:E.label},"Toediening"),description:r.a.createElement("span",null,"Dit is de administratie van waaruit u contacten wilt bekijken"),placeholder:"Administratie"},contactSection:{title:r.a.createElement("label",{style:E.label},"Contact"),description:r.a.createElement("span",null,"Selecteer de Contact waarvan je de facturen wilt tonen in de Tab."),placeholder:"contact"},tabTitle:"Moneybird facturen"}},A=function(e){var t,n;function a(){var t;return(t=e.call(this)||this).microsoftTeams&&t.microsoftTeams.initialize(),t.state={apiKey:"",adminId:"",admins:null,admin:null,contacts:null,contact:null,keys:[],isNew:!1,isOpen:!1},t.handleChange=t.handleChange.bind(w(t)),t.submit=t.submit.bind(w(t)),t.getOptions=t.getOptions.bind(w(t)),t.handleContact=t.handleContact.bind(w(t)),t.save=t.save.bind(w(t)),t.getAdmin=l()(t.getAdmin,2e3).bind(w(t)),t.handleToken=t.handleToken.bind(w(t)),t.handleAdmin=t.handleAdmin.bind(w(t)),t}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var o=a.prototype;return o.getAdmin=function(){var e=S(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:"administrations.json",key:t})});case 3:return n=e.sent,e.next=6,n.json();case 6:a=e.sent,console.log({json:a}),a.error?this.setState({admins:!1}):this.setState({admins:a}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),o.componentDidMount=function(){var e=this;this.microsoftTeams=window?window.microsoftTeams:null,this.microsoftTeams.initialize(),this.microsoftTeams.getContext(function(){var t=S(i.a.mark((function t(n){var a,o,r,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.tid,o=n.locale,t.prev=1,t.next=4,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/key/"+a,{mode:"cors",method:"GET"});case 4:return r=t.sent,t.next=7,r.json();case 7:s=t.sent,console.log({json:s}),e.setState({keys:s.map((function(e){return e.key})),locale:o}),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),console.log("BOOMER!"),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e){return t.apply(this,arguments)}}().bind(this))},o.getOptions=function(){return this.state.contacts.map((function(e){return{content:e.company_name,value:e.id}}))},o.handleContact=function(e,t){this.setState({contact:t.value},this.save)},o.handleAdmin=function(e,t){this.setState({admin:t.value}),this.submit(t.value)},o.handleChange=function(e){var t;this.setState(((t={})[e.target.name]=e.target.value,t))},o.handleToken=function(e,t){console.log({e:e,v:t}),e?(this.setState({apiKey:e.target.value,isOpen:!0}),this.getAdmin(e.target.value)):t&&(this.setState({apiKey:t.value,isOpen:!1}),this.getAdmin(t.value))},o.submit=function(){var e=S(i.a.mark((function e(t){var n,a,o,r,s=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.value,console.log(n),a=this.state,o=a.apiKey,r=a.isNew,this.microsoftTeams.initialize(),this.microsoftTeams.getContext(function(){var e=S(i.a.mark((function e(t){var a,l,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.tid,e.prev=1,e.next=4,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:n+"/contacts.json",key:o,tid:a,isNew:r})});case 4:return l=e.sent,e.next=7,l.json();case 7:c=e.sent,console.log({json:c}),s.setState({contacts:c}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.log("BOOM!"),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),o.save=function(){var e=this,t=this.state,n=t.apiKey,a=t.admin.value,i=t.contact,o=t.locale.split("-")[0];this.microsoftTeams.initialize(),this.microsoftTeams.settings.setValidityState(!0),this.microsoftTeams.settings.registerOnSaveHandler((function(t){e.microsoftTeams.settings.setSettings({websiteUrl:"https://jp5525.github.io/teams-demo/"+o+"/",contentUrl:"https://jp5525.github.io/teams-demo/"+o+"/",entityId:JSON.stringify({apiKey:n,adminId:a,contact:i}),suggestedDisplayName:T[o].tabTitle}),t.notifySuccess()}))},o.render=function(){var e=this,t=this.state,n=t.contacts,a=t.contact,i=t.admins,o=t.admin,s=t.apiKey,l=t.keys,v=t.isOpen,k=t.locale,S=k?T[k.split("-")[0]]:null;return console.log({keys:l}),S?r.a.createElement(c.a,{theme:d.themes.teams},r.a.createElement("div",{style:E.mainPadding},r.a.createElement("div",{style:E.mainTable},r.a.createElement(u.a,{content:"MoneyBird Opstelling"}),r.a.createElement(m.a,{gap:"gap.small",vAlign:"center",hAlign:"start"},r.a.createElement(p.a,{justifyContent:"center"},r.a.createElement("form",{onSubmit:this.submit,style:{width:"100%"}},S.apiSection.title," ",r.a.createElement("br",null),S.apiSection.description,0==i?r.a.createElement(r.a.Fragment,null," ",r.a.createElement("br",null),r.a.createElement(h.a,{content:S.apiSection.fail,icon:{as:b.a}})):null,i?r.a.createElement(r.a.Fragment,null," ",r.a.createElement("br",null),r.a.createElement(h.a,{content:S.apiSection.succsess,icon:{as:y.a}})):null,r.a.createElement(f.a,{items:l,placeholder:S.apiSection.placeholder,onChange:this.handleToken,name:"apiKey",id:"apiKey",clearable:s&&s.length>0,fluid:!0,search:!0,open:v,noResultsMessage:{content:"Add... "+s,onClick:function(t){e.setState({isNew:!0,keys:[s].concat(g(l)),isOpen:!1},e.getAdmin(s))},style:{cursor:"pointer"}}}),r.a.createElement("br",null),S.adminSection.title," ",r.a.createElement("br",null),S.adminSection.description,r.a.createElement(f.a,{items:i?i.map((function(e){return{content:e.name,value:e.id}})):[],value:o?o.content:null,placeholder:S.adminSection.placeholder,onChange:this.handleAdmin,name:"Admin",disabled:!i,fluid:!0}),r.a.createElement("br",null),S.contactSection.title," ",r.a.createElement("br",null),S.contactSection.description,r.a.createElement(f.a,{items:n?this.getOptions():[],value:a?a.content:null,placeholder:S.contactSection.placeholder,onChange:this.handleContact,name:"contact",disabled:!n}))))))):null},a}(r.a.Component);t.default=A}}]);
//# sourceMappingURL=component---src-pages-config-js-5708ec20e25f1649b6cc.js.map