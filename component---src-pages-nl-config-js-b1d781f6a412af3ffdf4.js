(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"/Ina":function(e,t,n){"use strict";n("rGqo"),n("yt8O"),n("Btvt"),n("RW0V"),n("91GP"),n("bWfx"),n("bHtr");var a=n("wx14"),r=n("mwIZ"),s=n.n(r),i=n("726e"),o=n("Vy0N"),l=n("GP9T"),c=n("GrCt"),u=n("17x9"),p=n("q1tI"),d=n("AMYI"),m=n("7X27"),b=n("ihDb"),f=n("wX7S"),h=function e(t){var n=p.useContext(d.b),r=Object(i.a)(e.displayName,n.telemetry),u=r.setStart,m=r.setEnd;u();var b=t.children,f=t.className,h=t.column,y=t.debug,g=t.design,v=t.fill,O=t.gap,j=t.hAlign,S=t.inline,N=t.padding,T=t.space,P=t.styles,k=t.variables,w=t.vAlign,x=t.wrap,E=Object(o.a)(e.displayName,{className:e.className,mapPropsToStyles:function(){return{column:h,debug:y,fill:v,gap:O,hAlign:j,inline:S,padding:N,space:T,vAlign:w,wrap:x}},mapPropsToInlineStyles:function(){return{className:f,design:g,styles:P,variables:k}},rtl:n.rtl}).classes,A=Object(l.a)(t),C=Object(c.a)(e.handledProps,t),I=p.Children.map(b,(function(e){return s()(e,"type.__isFlexItem")?p.cloneElement(e,{flexDirection:h?"column":"row"}):e})),z=p.createElement(A,Object(a.a)({className:E.root},C),I);return m(),z};h.className="ui-flex",h.displayName="Flex",h.propTypes=Object.assign({},m.commonPropTypes.createCommon({accessibility:!1,content:!1}),{inline:u.bool,column:u.bool,wrap:u.bool,hAlign:u.oneOf(["start","center","end","stretch"]),vAlign:u.oneOf(["start","center","end","stretch"]),space:u.oneOf(["around","between","evenly"]),gap:u.oneOf(["gap.smaller","gap.small","gap.medium","gap.large"]),padding:u.oneOf(["padding.medium"]),fill:u.bool,debug:u.bool}),h.handledProps=Object.keys(h.propTypes),h.Item=f.a,t.a=Object(b.a)(h)},JWvD:function(e,t,n){"use strict";n("91GP");var a=n("wx14"),r=n("1OyB"),s=n("vuIU"),i=n("md7G"),o=n("foSv"),l=n("Ji7U"),c=n("rePB"),u=n("q1tI"),p=n("4o4N"),d=n("oPHA"),m=n("QyKD"),b=n("7X27"),f=n("yX7n"),h=n("ihDb"),y=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"renderComponent",value:function(e){var t=e.accessibility,n=e.ElementType,r=e.classes,s=e.unhandledProps,i=this.props,o=i.children,l=i.content;return u.createElement(n,Object(a.a)({},p.a.getAttributes({forElements:[o,l]}),t.attributes.root,s,{className:r.root}),Object(d.a)(o)?o:l)}}]),t}(m.a);Object(c.a)(y,"create",void 0),Object(c.a)(y,"className","ui-header__description"),Object(c.a)(y,"displayName","HeaderDescription"),Object(c.a)(y,"propTypes",Object.assign({},b.commonPropTypes.createCommon({color:!0}))),Object(c.a)(y,"defaultProps",{as:"p"}),y.create=Object(f.a)({Component:y,mappedProp:"content"}),t.a=Object(h.a)(y)},"Z+mF":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={filled:"ui-icon__filled",outline:"ui-icon__outline"}},iUi7:function(e,t,n){"use strict";n("91GP");var a=n("wx14"),r=n("1OyB"),s=n("vuIU"),i=n("md7G"),o=n("foSv"),l=n("Ji7U"),c=n("rePB"),u=n("LfD4"),p=n("17x9"),d=n("q1tI"),m=n("oPHA"),b=n("4o4N"),f=n("QyKD"),h=n("7X27"),y=n("yX7n"),g=n("JWvD"),v=n("ihDb"),O=function(e){function t(){return Object(r.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"renderComponent",value:function(e){var n=e.accessibility,r=e.ElementType,s=e.classes,i=e.variables,o=e.unhandledProps,l=this.props,c=l.children,u=l.description,p=l.content,f=Object(m.a)(c),h=Object(m.a)(c)?c:p;return d.createElement(r,Object(a.a)({},b.a.getAttributes({forElements:[c,p],condition:!u}),n.attributes.root,o,{className:s.root}),b.a.createFor({element:h,condition:!!u}),!f&&g.a.create(u,{defaultProps:function(){return{className:t.slotClassNames.description,variables:Object.assign({},i.descriptionColor&&{color:i.descriptionColor})}}}))}}]),t}(f.a);Object(c.a)(O,"displayName","Header"),Object(c.a)(O,"className","ui-header"),Object(c.a)(O,"slotClassNames",{description:"".concat(O.className,"__description")}),Object(c.a)(O,"create",void 0),Object(c.a)(O,"propTypes",Object.assign({},h.commonPropTypes.createCommon({color:!0}),{description:u.i,align:u.b,rtlAttributes:p.func})),Object(c.a)(O,"defaultProps",{as:"h1"}),Object(c.a)(O,"Description",g.a),O.create=Object(y.a)({Component:O,mappedProp:"content"}),t.a=Object(v.a)(O)},"sBL/":function(e,t,n){function a(e,t,n){var a,r,s,i,o;function l(){var c=Date.now()-i;c<t&&c>=0?a=setTimeout(l,t-c):(a=null,n||(o=e.apply(s,r),s=r=null))}null==t&&(t=100);var c=function(){s=this,r=arguments,i=Date.now();var c=n&&!a;return a||(a=setTimeout(l,t)),c&&(o=e.apply(s,r),s=r=null),o};return c.clear=function(){a&&(clearTimeout(a),a=null)},c.flush=function(){a&&(o=e.apply(s,r),s=r=null,clearTimeout(a),a=null)},c}n("eM6i"),a.debounce=a,e.exports=a},tIxt:function(e,t,n){"use strict";n("91GP");var a=n("KQm4"),r=n("q1tI"),s=n("AMYI"),i=(n("DNiP"),n("rGqo"),n("yt8O"),n("Btvt"),n("RW0V"),n("Ff2n")),o=n("U8pU"),l=(n("7GkX"),n("3WF5"),n("v8eK"),n("QkVN")),c=n.n(l),u=n("bNQv"),p=n.n(u),d=function(e){return function(){return"function"==typeof e?e.apply(void 0,arguments):e}},m=(n("0l/t"),n("8+KV"),n("LK8F"),function(e){return null!==e&&"object"===Object(o.a)(e)&&!Array.isArray(e)}),b=function(){for(var e=function e(t,n){return Object.keys(n).forEach((function(a){m(n[a])?(m(t[a])||(t[a]={}),e(t[a],n[a])):t[a]=n[a]})),t},t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return n.filter(Boolean).reduce((function(t,n){return e(t,n)}),{})},f=(n("HAE/"),function(e,t){return e}),h={siteVariables:{fontSizes:{}},componentVariables:{},componentStyles:{},fontFaces:[],staticStyles:[],animations:{}},y=function(){for(var e={},t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return n.reduce((function(e,t){return p()(t,(function(t,n){var a=e[n],r=t;null==r||"object"===Object(o.a)(r)&&0===Object.keys(r).length||(e[n]=void 0!==a?function(e){return c()(a(e),d(r)(e))}:d(r))})),e}),e)},g=y,v=function(){for(var e=function(){return{}},t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return n.reduce((function(e,t){return function(){var n=e.apply(void 0,arguments),a=d(t).apply(void 0,arguments);return b(n,a)}}),e)},O=v,j=(n("E+oP"),n("k4Da"),n("bWfx"),n("XfO3"),n("EK0E"),new WeakMap),S=function(e,t,n,r){var s,i=e.filter((function(e){return!!t.componentVariables[e]}));if(r){j.has(t)||j.set(t,{});var o=j.get(t)||{},l=i[i.length-1];o[l]||(o[l]=O.apply(void 0,Object(a.a)(i.map((function(e){return t.componentVariables[e]}))))(t.siteVariables),j.set(t,o)),s=o[l]}else s=1===i.length?d(t.componentVariables[i[0]])(t.siteVariables)||{}:O.apply(void 0,Object(a.a)(i.map((function(e){return t.componentVariables[e]}))))(t.siteVariables);return void 0===n?s:O(s,f(n,"props.variables"))(t.siteVariables)},N=n("rePB"),T=n("YO3V"),P=n.n(T),k=n("TSYQ"),w=n.n(k),x=new WeakMap,E=new WeakMap,A=function(e,t,n){var r=e.className,s=e.theme,o=e.displayNames,l=e.props,c=e.rtl,u=e.disableAnimations,p=e.renderer,d=e.performance,m=l.className,b=l.design,h=l.styles,y=l.variables,v=Object(i.a)(l,["className","design","styles","variables"]),O=!(b||h),j=d.enableBooleanVariablesCaching||!y;d.enableBooleanVariablesCaching&&(P()(y)&&Object.keys(y).every((function(e){return null===y[e]||void 0===y[e]||"boolean"==typeof y[e]}))||(j=!1));var S,T=d.enableStylesCaching&&O&&j;if(1===o.length)S=s.componentStyles[o[0]]||{root:function(){return{}}};else{var k=o.map((function(e){return s.componentStyles[e]})).filter(Boolean);S=k.length>0?g.apply(void 0,Object(a.a)(k)):{root:function(){return{}}}}O||(S=g(S,l.design&&f({root:l.design},"props.design"),l.styles&&f({root:l.styles},"props.styles")));var A={props:l,variables:t,theme:s,rtl:c,disableAnimations:u},C={theme:{direction:c?"rtl":"ltr"},disableAnimations:u,displayName:o.join(":"),sanitizeCss:d.enableSanitizeCssPlugin},I=n||function(e){return p.renderRule((function(){return e}),C)},z={},V={};T&&s&&(E.has(s)||E.set(s,{}),x.has(s)||x.set(s,{}));var M=T?JSON.stringify(v):"",B=T&&d.enableBooleanVariablesCaching?JSON.stringify(y):"",D=T?"".concat(o.join(":"),":").concat(M,":").concat(B,":").concat(A.rtl).concat(A.disableAnimations):"";return Object.keys(S).forEach((function(e){var t="".concat(e,"__return"),n=D+e;Object.defineProperty(z,e,{enumerable:!1,configurable:!1,set:function(e){T&&s&&E.set(s,Object.assign({},E.get(s),Object(N.a)({},n,e))),z[t]=e},get:function(){if(T&&s){var a=E.get(s)||{};if(a[n])return a[n]}return z[t]||(z[t]=S[e](A),T&&s&&E.set(s,Object.assign({},E.get(s),Object(N.a)({},n,z[t])))),z[t]}}),Object.defineProperty(V,e,{enumerable:!1,configurable:!1,set:function(e){T&&s&&x.set(s,Object.assign({},x.get(s),Object(N.a)({},n,e))),V[t]=e},get:function(){if(T&&s){var a=x.get(s)||{};if(a[n]||""===a[n])return"root"===e?w()(r,a[n],m):a[n]}if(V[t])return"root"===e?w()(r,V[t],m):V[t];var i=z[e];return I&&i&&(V[t]=I(i),T&&s&&x.set(s,Object.assign({},x.get(s),Object(N.a)({},n,V[t])))),"root"===e?w()(r,V[t],m):V[t]}})})),{resolvedStyles:z,resolvedStylesDebug:{},classes:V}},C=function(e){var t=S(e.displayNames,e.theme,e.props.variables,e.performance.enableVariablesCaching),n=A(e,t),a=n.classes,r=n.resolvedStyles;n.resolvedStylesDebug;return{classes:a,variables:t,styles:r,theme:e.theme}},I={rtl:!1,disableAnimations:!1,performance:{enableSanitizeCssPlugin:!1,enableStylesCaching:!0,enableVariablesCaching:!0,enableBooleanVariablesCaching:!1},renderer:{renderRule:function(){return""}},theme:h},z=function(e,t){var n,a=r.useContext(s.b)||I,i=t.className,o=void 0===i?"":i,l=t.composeOptions,c=t.mapPropsToStyles,u=void 0===c?function(){return{}}:c,p=t.mapPropsToInlineStyles,d=void 0===p?function(){return{}}:p,m=t.unstable_props,b=void 0===m?{}:m,f=t.rtl,h=void 0!==f&&f,y=u(),g=Object.assign({},b,{},y),v=null==l||null===(n=l.mapPropsToStylesPropsChain)||void 0===n?void 0:n.reduce((function(e,t){return Object.assign({},e,{},t(g))}),{}),O=r.useRef({fluentUIDebug:null}),j=C({className:(null==l?void 0:l.className)||o,displayNames:(null==l?void 0:l.displayNames)||[e],props:Object.assign({},y,{},d(),{},v),disableAnimations:a.disableAnimations,renderer:a.renderer,rtl:h,saveDebug:function(e){return O.current={fluentUIDebug:e}},theme:a.theme,performance:a.performance});return{classes:j.classes,styles:j.styles}};n("V+eJ");var V=function(e,t){return Object.keys(t).reduce((function(n,a){return-1===e.indexOf(a)&&(n[a]=t[a]),n}),{})},M=["bordered","className","circular","design","disabled","outline","size","rotate","styles","variables","xSpacing"];t.a=function(e){var t=e.svg,n=e.displayName,i=e.handledProps,o=void 0===i?[]:i,l=function(e){var n=r.useContext(s.b),i=e.alt,l=e["aria-label"],c=e.bordered,u=e.circular,p=e.className,d=e.design,m=e.disabled,b=e.outline,f=e.rotate,h=void 0===f?0:f,y=e.size,g=void 0===y?"medium":y,v=e.styles,O=e.variables,j=e.xSpacing,S=z("SvgIcon",{className:"ui-icon",mapPropsToStyles:function(){return{bordered:c,circular:u,disabled:m,outline:b,rotate:h,size:g,xSpacing:j}},mapPropsToInlineStyles:function(){return{className:p,design:d,styles:v,variables:O}},rtl:n.rtl}).classes,N=V([].concat(M,Object(a.a)(o)),e);return r.createElement("span",Object.assign({role:"img","aria-hidden":i||l?void 0:"true","aria-label":l,className:S.root},N),t({classes:S,rtl:n.rtl,props:e}))};return l.displayName=n,l.handledProps=[].concat(M,Object(a.a)(o)),l}},v1ff:function(e,t,n){"use strict";n.r(t);n("f3/d"),n("a1Th"),n("XfO3"),n("HEwt"),n("rE2o"),n("ioFf"),n("VRzm"),n("rGqo"),n("yt8O"),n("Btvt"),n("KKXr");var a=n("o0o1"),r=n.n(a),s=(n("ls82"),n("q1tI")),i=n.n(s),o=(n("sBL/"),n("3r0M")),l=n("XyXI"),c=n("QRbW"),u=n("iUi7"),p=n("/Ina"),d=n("wX7S"),m=n("iY3s"),b=n("Skks"),f=n("TSYQ"),h=n.n(f),y=n("tIxt"),g=n("Z+mF"),v=Object(y.a)({svg:function(e){var t=e.classes;return s.createElement("svg",{role:"presentation",focusable:"false",viewBox:"8 8 16 16",className:t.svg},s.createElement("g",null,s.createElement("path",{className:h()(g.a.outline,t.outlinePart),d:"M16.707 16l4.243-4.243a.5.5 0 1 0-.707-.707L16 15.293l-4.243-4.243a.5.5 0 1 0-.707.707L15.293 16l-4.243 4.243a.5.5 0 1 0 .707.707L16 16.707l4.243 4.243a.498.498 0 0 0 .707 0 .5.5 0 0 0 0-.707L16.707 16z"}),s.createElement("path",{className:h()(g.a.filled,t.filledPart),d:"M17.414 16l3.89-3.89a1 1 0 1 0-1.415-1.413L16 14.586l-3.89-3.89a1 1 0 1 0-1.413 1.415L14.586 16l-3.89 3.89a1 1 0 1 0 1.415 1.413L16 17.414l3.89 3.89a.997.997 0 0 0 1.413 0 1 1 0 0 0 0-1.415L17.414 16z"})))},displayName:"CloseIcon"}),O=Object(y.a)({svg:function(e){var t=e.classes;return s.createElement("svg",{role:"presentation",focusable:"false",viewBox:"8 8 16 16",className:t.svg},s.createElement("g",null,s.createElement("path",{className:h()(g.a.outline,t.outlinePart),d:"M14.3 21.3c-.1 0-.3 0-.4-.1l-4.8-4.8c-.2-.2-.2-.5 0-.7s.5-.2.7 0l4.4 4.4 7.9-7.9c.2-.2.5-.2.7 0s.2.5 0 .7l-8.3 8.3s-.1.1-.2.1z"}),s.createElement("path",{className:h()(g.a.filled,t.filledPart),d:"M23.5 11.875a.968.968 0 0 1-.289.711l-8.25 8.25c-.192.193-.43.289-.711.289s-.519-.096-.711-.289l-4.75-4.75a.965.965 0 0 1-.289-.711c0-.125.027-.25.082-.375s.129-.234.223-.328a.953.953 0 0 1 .695-.297c.135 0 .266.025.391.074.125.05.231.121.32.215l4.039 4.047 7.539-7.547a.886.886 0 0 1 .32-.215c.125-.049.255-.074.391-.074a1.004 1.004 0 0 1 .922.625.97.97 0 0 1 .078.375z"})))},displayName:"AcceptIcon"});function j(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function N(e,t,n,a,r,s,i){try{var o=e[s](i),l=o.value}catch(c){return void n(c)}o.done?t(l):Promise.resolve(l).then(a,r)}function T(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var s=e.apply(t,n);function i(e){N(s,a,r,i,o,"next",e)}function o(e){N(s,a,r,i,o,"throw",e)}i(void 0)}))}}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var k={mainPadding:{padding:"0px 2em"},mainSidePadding:{padding:"10px 2em"},mainPdf:{display:"flex",justifyContent:"center"},mainTable:{backgroundColor:"#fff",border:"1px solid #d8e2f0",borderRadius:"4px",boxShadow:"0 0 10px 0 rgba(19,29,41,.05)",position:"relative",padding:"0em 3em 2em"},backButton:{cusor:"pointer"},label:{fontWeight:"bold"}},w={en:{heading:"Moneybird Configuration",apiSection:{title:i.a.createElement("label",{style:k.label},"API Token"),description:i.a.createElement("span",null,"This is the API Token for you MoneyBird Account. You can generate one ",i.a.createElement("a",{target:"_blank",href:"https://moneybird.com/user/applications/new"},"here")," for personal use."),succsess:"API Token IS vaild",fail:"API Token NOT vaild",placeholder:"API Token"},contactSection:{title:i.a.createElement("label",{style:k.label},"Contact"),description:i.a.createElement("span",null,"The contact whos invoice's will show up on the invoices tabs"),placeholder:"Contact"},tabs:["Invoices","Quotes"]},nl:{heading:"Moneybird Koppelen",apiSection:{title:i.a.createElement("label",{style:k.label},"API token invoeren"),description:i.a.createElement("span",null,"Vul hier een API-token in van je Moneybird account. Je kunt ",i.a.createElement("a",{target:"_blank",href:"https://moneybird.com/user/applications/new"},"hier")," een API-token genereren. Vul een naam in die herkenbaar is voor deze connectie, bijvoorbeeld ‘Microsoft Teams Integratie’. Kies voor ‘API token voor persoonlijk gebruik’ en geef in ieder geval toegang voor alle onderdelen. Vervolgens verschijnt er een API-token in beeld. Vul deze hieronder in."),succsess:"API-token niet geldig",fail:"API-token IS geldig",placeholder:"API token invoeren"},contactSection:{title:i.a.createElement("label",{style:k.label},"Contact"),description:i.a.createElement("span",null,"Selecteer de Contact waarvan je de facturen wilt tonen in de Tab."),placeholder:"contact"},tabs:["Facturen","Citaten"]}},x=function(e){var t,n;function a(){var t;return(t=e.call(this)||this).microsoftTeams&&t.microsoftTeams.initialize(),t.state={apiKey:"",adminId:"",admins:null,admin:null,contacts:null,contact:null,loadingContacts:!1,keys:[],isNew:!1,isOpen:!1,isContactsOpen:!1,locale:"en-us",tabType:"invoices"},t.submit=t.submit.bind(P(t)),t.getOptions=t.getOptions.bind(P(t)),t.save=t.save.bind(P(t)),t.getAdmin=t.getAdmin.bind(P(t)),t.handleToken=t.handleToken.bind(P(t)),t.handleAdmin=t.handleAdmin.bind(P(t)),t.getContacts=t.getContacts.bind(P(t)),t}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n;var s=a.prototype;return s.getAdmin=function(){var e=T(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:"administrations.json",key:t})});case 3:return n=e.sent,e.next=6,n.json();case 6:a=e.sent,console.log({json:a}),a.error?this.setState({admins:!1}):(this.setState({admin:a[0],adminId:a[0].id,admins:!0}),this.submit(a[0])),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),s.componentDidMount=function(){var e=this;this.microsoftTeams=window?window.microsoftTeams:null,this.microsoftTeams.initialize(),this.microsoftTeams.getContext(function(){var t=T(r.a.mark((function t(n){var a,s,i,o;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.tid,s=n.locale,t.prev=1,t.next=4,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/key/"+a,{mode:"cors",method:"GET"});case 4:return i=t.sent,t.next=7,i.json();case 7:o=t.sent,console.log({json:o}),e.setState({keys:o.map((function(e){return e.key})),locale:s}),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),console.log("BOOMER!"),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e){return t.apply(this,arguments)}}().bind(this))},s.getOptions=function(){return this.state.contacts.map((function(e){return{content:e.company_name,value:e.id}}))},s.handleAdmin=function(e,t){this.setState({admin:t.value}),this.submit(t.value)},s.getContacts=function(){var e=T(r.a.mark((function e(t,n){var a,s,i,o,l,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=21;break}return a=this.state,s=a.apiKey,i=a.adminId,o=t.target.value,e.prev=3,this.setState({loadingContacts:!0}),e.next=7,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:i+"/contacts.json"+(r=o,null==r||0==r.length?"":"?query="+o),key:s})});case 7:return l=e.sent,e.next=10,l.json();case 10:c=e.sent,console.log({json:c}),this.setState({contacts:c,loadingContacts:!1}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(3),console.log("BOOM!"),console.log(e.t0);case 19:e.next=22;break;case 21:this.setState({contact:n.value},this.save);case 22:case"end":return e.stop()}var r}),e,this,[[3,15]])})));return function(t,n){return e.apply(this,arguments)}}(),s.handleToken=function(e,t){console.log({e:e,v:t}),e?this.setState({apiKey:e.target.value,isOpen:!0}):t&&(this.setState({apiKey:t.value,isOpen:!1}),this.getAdmin(t.value))},s.submit=function(){var e=T(r.a.mark((function e(t){var n,a,s,i,o=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.id,console.log(n),a=this.state,s=a.apiKey,i=a.isNew,this.microsoftTeams.initialize(),this.microsoftTeams.getContext(function(){var e=T(r.a.mark((function e(t){var a,l,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.tid,e.prev=1,e.next=4,fetch("https://moneybirdhandlerproxy.azurewebsites.net/api/MoneyBirdProxy",{mode:"cors",method:"POST",body:JSON.stringify({method:"GET",path:n+"/contacts.json",key:s,tid:a,isNew:i})});case 4:return l=e.sent,e.next=7,l.json();case 7:c=e.sent,console.log({json:c}),o.setState({contacts:c}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.log("BOOM!"),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.save=function(){var e=this,t=this.state,n=t.apiKey,a=t.adminId,r=t.contact,s=t.locale,i=t.tabType,o=s.split("-")[0];this.microsoftTeams.initialize(),this.microsoftTeams.settings.setValidityState(!0),this.microsoftTeams.settings.registerOnSaveHandler((function(t){e.microsoftTeams.settings.setSettings({websiteUrl:"invoices"==i?"https://jp5525.github.io/teams-demo/invoices":"https://jp5525.github.io/teams-demo/quotes",contentUrl:"invoices"==i?"https://jp5525.github.io/teams-demo/invoices":"https://jp5525.github.io/teams-demo/quotes",entityId:JSON.stringify({apiKey:n,adminId:a,contact:r}),suggestedDisplayName:"Moneybird "+("invoices"==i?w[o].tabs[0]:w[o].tabs[1])}),t.notifySuccess()}))},s.render=function(){var e=this,t=this.state,n=t.contacts,a=t.contact,r=t.admins,s=(t.admin,t.apiKey),f=t.keys,h=t.isOpen,y=t.locale,g=t.loadingContacts,S=y?w[y.split("-")[0]]:null,N=S?[{key:"invoices",header:S.tabs[0],onClick:function(){return e.setState({tabType:"invoices"})}},{key:"quotes",header:S.tabs[1],onClick:function(){return e.setState({tabType:"quotes"})}}]:null;return S?i.a.createElement(o.a,{theme:l.themes.teams},i.a.createElement(c.a,{style:k.mainPadding,selectable:!0,defaultSelectedIndex:0,items:N,horizontal:!0}),i.a.createElement("div",{style:k.mainPadding},i.a.createElement("div",{style:k.mainTable},i.a.createElement(u.a,{content:S.heading}),i.a.createElement(p.a,{gap:"gap.small",vAlign:"center",hAlign:"start"},i.a.createElement(d.a,{justifyContent:"center"},i.a.createElement("form",{onSubmit:this.submit,style:{width:"100%"}},S.apiSection.title," ",i.a.createElement("br",null),S.apiSection.description,0==r?i.a.createElement(i.a.Fragment,null," ",i.a.createElement("br",null),i.a.createElement(m.a,{content:S.apiSection.fail,icon:{as:v}})):null,r?i.a.createElement(i.a.Fragment,null," ",i.a.createElement("br",null),i.a.createElement(m.a,{content:S.apiSection.succsess,icon:{as:O}})):null,i.a.createElement(b.a,{items:f,placeholder:S.apiSection.placeholder,onChange:this.handleToken,name:"apiKey",id:"apiKey",clearable:s&&s.length>0,fluid:!0,search:!0,open:h,noResultsMessage:{content:"Add... "+s,onClick:function(t){e.setState({isNew:!0,keys:[s].concat(j(f)),isOpen:!1},(function(){return e.getAdmin(s)}))},style:{cursor:"pointer"}}}),i.a.createElement("br",null),S.contactSection.title," ",i.a.createElement("br",null),S.contactSection.description,i.a.createElement(b.a,{ref:function(t){return e.drop=t},items:n?this.getOptions():[],value:a?a.content:null,placeholder:S.contactSection.placeholder,search:!0,loading:g,loadingMessage:"Loading...",onChange:this.getContacts,name:"contact",disabled:!n,itemToString:function(e){return e?e.content:""},fluid:!0}))))))):null},a}(i.a.Component);t.default=x},wX7S:function(e,t,n){"use strict";n("91GP");var a=n("J2iB"),r=n.n(a),s=n("726e"),i=n("Vy0N"),o=n("1ine"),l=n("TSYQ"),c=n.n(l),u=n("17x9"),p=n("q1tI"),d=n("AMYI"),m=n("7X27"),b=function e(t){var n=p.useContext(d.b),a=Object(s.a)(e.displayName,n.telemetry),l=a.setStart,u=a.setEnd;l();var m,b=t.align,f=t.children,h=t.className,y=t.design,g=t.grow,v=t.flexDirection,O=t.push,j=t.shrink,S=t.size,N=t.styles,T=t.variables,P=Object(i.a)(e.displayName,{className:e.className,mapPropsToStyles:function(){return{align:b,grow:g,flexDirection:v,push:O,shrink:j,size:S}},mapPropsToInlineStyles:function(){return{className:h,design:y,styles:N,variables:T}},rtl:n.rtl}),k=P.classes,w=P.styles;return m="function"==typeof f?f({styles:w.root,classes:k.root}):r()(f)?null:function(e,t,n){return t?"string"==typeof e.type?p.cloneElement(e,{className:c()(e.props.className,n.root)}):p.cloneElement(e,{styles:Object(o.f)(t.root||{},e.props.styles)}):e}(p.Children.only(f),w,k),u(),m};b.className="ui-flex__item",b.displayName="FlexItem",b.propTypes=Object.assign({},m.commonPropTypes.createCommon({children:!1,accessibility:!1,content:!1}),{children:u.oneOfType([u.element,u.func]),align:u.oneOf(["auto","start","end","center","baseline","stretch"]),size:u.oneOfType([u.oneOf(["size.half","size.quarter","size.small","size.medium","size.large"]),u.string]),shrink:u.oneOfType([u.bool,u.number]),push:u.bool,flexDirection:u.oneOf(["row","column"])}),b.__isFlexItem=!0,t.a=b}}]);
//# sourceMappingURL=component---src-pages-nl-config-js-b1d781f6a412af3ffdf4.js.map